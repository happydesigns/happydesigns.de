window.apsinth={util:{},msg:{}},null==window.console&&(window.console={log:function(){},error:function(){},warn:function(){},debug:function(){}}),jQuery.ui||function(t){var e=t.fn.remove,i=t.browser.mozilla&&parseFloat(t.browser.version)<1.9;if(t.ui={version:"1.7.2",plugin:{add:function(e,i,s){var n=t.ui[e].prototype;for(var a in s)n.plugins[a]=n.plugins[a]||[],n.plugins[a].push([i,s[a]])},call:function(t,e,i){var s=t.plugins[e];if(s&&t.element[0].parentNode)for(var n=0;n<s.length;n++)t.options[s[n][0]]&&s[n][1].apply(t.element,i)}},contains:function(t,e){return document.compareDocumentPosition?16&t.compareDocumentPosition(e):t!==e&&t.contains(e)},hasScroll:function(e,i){if("hidden"==t(e).css("overflow"))return!1;var s,n=i&&"left"==i?"scrollLeft":"scrollTop";return e[n]>0||(e[n]=1,s=e[n]>0,e[n]=0,s)},isOverAxis:function(t,e,i){return t>e&&t<e+i},isOver:function(e,i,s,n,a,r){return t.ui.isOverAxis(e,s,a)&&t.ui.isOverAxis(i,n,r)},keyCode:{BACKSPACE:8,CAPS_LOCK:20,COMMA:188,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38}},i){var s=t.attr,n=t.fn.removeAttr,a="http://www.w3.org/2005/07/aaa",r=/^aria-/,o=/^wairole:/;t.attr=function(t,e,i){var n=void 0!==i;return"role"==e?n?s.call(this,t,e,"wairole:"+i):(s.apply(this,arguments)||"").replace(o,""):r.test(e)?n?t.setAttributeNS(a,e.replace(r,"aaa:"),i):s.call(this,t,e.replace(r,"aaa:")):s.apply(this,arguments)},t.fn.removeAttr=function(t){return r.test(t)?this.each(function(){this.removeAttributeNS(a,t.replace(r,""))}):n.call(this,t)}}t.fn.extend({remove:function(){return t("*",this).add(this).each(function(){t(this).triggerHandler("remove")}),e.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","").unbind("selectstart.ui")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})},scrollParent:function(){var e;return e=t.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.curCSS(this,"position",1))&&/(auto|scroll)/.test(t.curCSS(this,"overflow",1)+t.curCSS(this,"overflow-y",1)+t.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.curCSS(this,"overflow",1)+t.curCSS(this,"overflow-y",1)+t.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e}}),t.extend(t.expr[":"],{data:function(e,i,s){return!!t.data(e,s[3])},focusable:function(e){var i=e.nodeName.toLowerCase(),s=t.attr(e,"tabindex");return(/input|select|textarea|button|object/.test(i)?!e.disabled:("a"==i||"area"==i)&&e.href||!isNaN(s))&&!t(e)["area"==i?"parents":"closest"](":hidden").length},tabbable:function(e){var i=t.attr(e,"tabindex");return(isNaN(i)||i>=0)&&t(e).is(":focusable")}}),t.widget=function(e,i){var s=e.split(".")[0];e=e.split(".")[1],t.fn[e]=function(i){var n="string"==typeof i,a=Array.prototype.slice.call(arguments,1);if(n&&"_"==i.substring(0,1))return this;if(n&&function(e,i,s,n){function a(s){var n=t[e][i][s]||[];return"string"==typeof n?n.split(/,?\s+/):n}var r=a("getter");return 1==n.length&&"string"==typeof n[0]&&(r=r.concat(a("getterSetter"))),-1!=t.inArray(s,r)}(s,e,i,a)){var r=t.data(this[0],e);return r?r[i].apply(r,a):void 0}return this.each(function(){var r=t.data(this,e);!r&&!n&&t.data(this,e,new t[s][e](this,i))._init(),r&&n&&t.isFunction(r[i])&&r[i].apply(r,a)})},t[s]=t[s]||{},t[s][e]=function(i,n){var a=this;this.namespace=s,this.widgetName=e,this.widgetEventPrefix=t[s][e].eventPrefix||e,this.widgetBaseClass=s+"-"+e,this.options=t.extend({},t.widget.defaults,t[s][e].defaults,t.metadata&&t.metadata.get(i)[e],n),this.element=t(i).bind("setData."+e,function(t,e,s){if(t.target==i)return a._setData(e,s)}).bind("getData."+e,function(t,e){if(t.target==i)return a._getData(e)}).bind("remove",function(){return a.destroy()})},t[s][e].prototype=t.extend({},t.widget.prototype,i),t[s][e].getterSetter="option"},t.widget.prototype={_init:function(){},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled")},option:function(e,i){var s=e,n=this;if("string"==typeof e){if(void 0===i)return this._getData(e);(s={})[e]=i}t.each(s,function(t,e){n._setData(t,e)})},_getData:function(t){return this.options[t]},_setData:function(t,e){this.options[t]=e,"disabled"==t&&this.element[e?"addClass":"removeClass"](this.widgetBaseClass+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",e)},enable:function(){this._setData("disabled",!1)},disable:function(){this._setData("disabled",!0)},_trigger:function(e,i,s){var n=this.options[e],a=e==this.widgetEventPrefix?e:this.widgetEventPrefix+e;if((i=t.Event(i)).type=a,i.originalEvent)for(var r,o=t.event.props.length;o;)i[r=t.event.props[--o]]=i.originalEvent[r];return this.element.trigger(i,s),!(t.isFunction(n)&&!1===n.call(this.element[0],i,s)||i.isDefaultPrevented())}},t.widget.defaults={disabled:!1},t.ui.mouse={_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(t){if(e._preventClickEvent)return e._preventClickEvent=!1,t.stopImmediatePropagation(),!1}),t.browser.msie&&(this._mouseUnselectable=this.element.attr("unselectable"),this.element.attr("unselectable","on")),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),t.browser.msie&&this.element.attr("unselectable",this._mouseUnselectable)},_mouseDown:function(e){if(e.originalEvent=e.originalEvent||{},!e.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var i=this,s=1==e.which,n="string"==typeof this.options.cancel&&t(e.target).parents().add(e.target).filter(this.options.cancel).length;return!(s&&!n&&this._mouseCapture(e))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(e),!this._mouseStarted)?(e.preventDefault(),!0):(this._mouseMoveDelegate=function(t){return i._mouseMove(t)},this._mouseUpDelegate=function(t){return i._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.browser.safari||e.preventDefault(),e.originalEvent.mouseHandled=!0,!0))}},_mouseMove:function(e){return t.browser.msie&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,this._preventClickEvent=e.target==this._mouseDownEvent.target,this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(t){return this.mouseDelayMet},_mouseStart:function(t){},_mouseDrag:function(t){},_mouseStop:function(t){},_mouseCapture:function(t){return!0}},t.ui.mouse.defaults={cancel:null,distance:1,delay:0}}(jQuery),jQuery.ui&&jQuery.ui.draggable||function(t){t.widget("ui.draggable",t.extend({},t.ui.mouse,{_init:function(){"original"!=this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){this.element.data("draggable")&&(this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return!(this.helper||i.disabled||t(e.target).is(".ui-resizable-handle"))&&(this.handle=this._getHandle(e),!!this.handle)},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),i.containment&&this._setContainment(),this._trigger("start",e),this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(e,!0),!0},_mouseDrag:function(e,i){if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!i){var s=this._uiHash();this._trigger("drag",e,s),this.position=s.position}return this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=!1;if(t.ui.ddmanager&&!this.options.dropBehaviour&&(i=t.ui.ddmanager.drop(this,e)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"==this.options.revert&&!i||"valid"==this.options.revert&&i||!0===this.options.revert||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)){var s=this;t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){s._trigger("stop",e),s._clear()})}else this._trigger("stop",e),this._clear();return!1},_getHandle:function(e){var i=!this.options.handle||!t(this.options.handle,this.element).length;return t(this.options.handle,this.element).find("*").andSelf().each(function(){this==e.target&&(i=!0)}),i},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e])):"clone"==i.helper?this.element.clone():this.element;return s.parents("body").length||s.appendTo("parent"==i.appendTo?this.element[0].parentNode:i.appendTo),s[0]==this.element[0]||/(fixed|absolute)/.test(s.css("position"))||s.css("position","absolute"),s},_adjustOffsetFromHelper:function(t){null!=t.left&&(this.offset.click.left=t.left+this.margins.left),null!=t.right&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),null!=t.top&&(this.offset.click.top=t.top+this.margins.top),null!=t.bottom&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&t.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&t.browser.msie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if("parent"==e.containment&&(e.containment=this.helper[0].parentNode),"document"!=e.containment&&"window"!=e.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"==e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||e.containment.constructor==Array)e.containment.constructor==Array&&(this.containment=e.containment);else{var i=t(e.containment)[0];if(!i)return;var s=t(e.containment).offset(),n="hidden"!=t(i).css("overflow");this.containment=[s.left+(parseInt(t(i).css("borderLeftWidth"),10)||0)+(parseInt(t(i).css("paddingLeft"),10)||0)-this.margins.left,s.top+(parseInt(t(i).css("borderTopWidth"),10)||0)+(parseInt(t(i).css("paddingTop"),10)||0)-this.margins.top,s.left+(n?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t(i).css("borderLeftWidth"),10)||0)-(parseInt(t(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,s.top+(n?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t(i).css("borderTopWidth"),10)||0)-(parseInt(t(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"==e?1:-1,n=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),a=/(html|body)/i.test(n[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-(t.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():a?0:n.scrollTop())*s),left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-(t.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():a?0:n.scrollLeft())*s)}},_generatePosition:function(e){var i=this.options,s="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,n=/(html|body)/i.test(s[0].tagName);"relative"!=this.cssPosition||this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset());var a=e.pageX,r=e.pageY;if(this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(r=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(r=this.containment[3]+this.offset.click.top)),i.grid)){var o=this.originalPageY+Math.round((r-this.originalPageY)/i.grid[1])*i.grid[1];r=this.containment&&(o-this.offset.click.top<this.containment[1]||o-this.offset.click.top>this.containment[3])?o-this.offset.click.top<this.containment[1]?o+i.grid[1]:o-i.grid[1]:o;var l=this.originalPageX+Math.round((a-this.originalPageX)/i.grid[0])*i.grid[0];a=this.containment&&(l-this.offset.click.left<this.containment[0]||l-this.offset.click.left>this.containment[2])?l-this.offset.click.left<this.containment[0]?l+i.grid[0]:l-i.grid[0]:l}return{top:r-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(t.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():n?0:s.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(t.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():n?0:s.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]==this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,i,s){return s=s||this._uiHash(),t.ui.plugin.call(this,e,[i,s]),"drag"==e&&(this.positionAbs=this._convertPositionTo("absolute")),t.widget.prototype._trigger.call(this,e,i,s)},plugins:{},_uiHash:function(t){return{helper:this.helper,position:this.position,absolutePosition:this.positionAbs,offset:this.positionAbs}}})),t.extend(t.ui.draggable,{version:"1.7.2",eventPrefix:"drag",defaults:{addClasses:!0,appendTo:"parent",axis:!1,cancel:":input,option",connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,delay:0,distance:1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i){var s=t(this).data("draggable"),n=s.options,a=t.extend({},i,{item:s.element});s.sortables=[],t(n.connectToSortable).each(function(){var i=t.data(this,"sortable");i&&!i.options.disabled&&(s.sortables.push({instance:i,shouldRevert:i.options.revert}),i._refreshItems(),i._trigger("activate",e,a))})},stop:function(e,i){var s=t(this).data("draggable"),n=t.extend({},i,{item:s.element});t.each(s.sortables,function(){this.instance.isOver?(this.instance.isOver=0,s.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"==s.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,n))})},drag:function(e,i){var s=t(this).data("draggable"),n=this;t.each(s.sortables,function(a){this.instance.positionAbs=s.positionAbs,this.instance.helperProportions=s.helperProportions,this.instance.offset.click=s.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(n).clone().appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=s.offset.click.top,this.instance.offset.click.left=s.offset.click.left,this.instance.offset.parent.left-=s.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=s.offset.parent.top-this.instance.offset.parent.top,s._trigger("toSortable",e),s.dropped=this.instance.element,s.currentItem=s.element,this.instance.fromOutside=s),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),s._trigger("fromSortable",e),s.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i){var s=t("body"),n=t(this).data("draggable").options;s.css("cursor")&&(n._cursor=s.css("cursor")),s.css("cursor",n.cursor)},stop:function(e,i){var s=t(this).data("draggable").options;s._cursor&&t("body").css("cursor",s._cursor)}}),t.ui.plugin.add("draggable","iframeFix",{start:function(e,i){var s=t(this).data("draggable").options;t(!0===s.iframeFix?"iframe":s.iframeFix).each(function(){t('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")})},stop:function(e,i){t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i){var s=t(i.helper),n=t(this).data("draggable").options;s.css("opacity")&&(n._opacity=s.css("opacity")),s.css("opacity",n.opacity)},stop:function(e,i){var s=t(this).data("draggable").options;s._opacity&&t(i.helper).css("opacity",s._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(e,i){var s=t(this).data("draggable");s.scrollParent[0]!=document&&"HTML"!=s.scrollParent[0].tagName&&(s.overflowOffset=s.scrollParent.offset())},drag:function(e,i){var s=t(this).data("draggable"),n=s.options,a=!1;s.scrollParent[0]!=document&&"HTML"!=s.scrollParent[0].tagName?(n.axis&&"x"==n.axis||(s.overflowOffset.top+s.scrollParent[0].offsetHeight-e.pageY<n.scrollSensitivity?s.scrollParent[0].scrollTop=a=s.scrollParent[0].scrollTop+n.scrollSpeed:e.pageY-s.overflowOffset.top<n.scrollSensitivity&&(s.scrollParent[0].scrollTop=a=s.scrollParent[0].scrollTop-n.scrollSpeed)),n.axis&&"y"==n.axis||(s.overflowOffset.left+s.scrollParent[0].offsetWidth-e.pageX<n.scrollSensitivity?s.scrollParent[0].scrollLeft=a=s.scrollParent[0].scrollLeft+n.scrollSpeed:e.pageX-s.overflowOffset.left<n.scrollSensitivity&&(s.scrollParent[0].scrollLeft=a=s.scrollParent[0].scrollLeft-n.scrollSpeed))):(n.axis&&"x"==n.axis||(e.pageY-t(document).scrollTop()<n.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-n.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<n.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+n.scrollSpeed))),n.axis&&"y"==n.axis||(e.pageX-t(document).scrollLeft()<n.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-n.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<n.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+n.scrollSpeed)))),!1!==a&&t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(s,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i){var s=t(this).data("draggable"),n=s.options;s.snapElements=[],t(n.snap.constructor!=String?n.snap.items||":data(draggable)":n.snap).each(function(){var e=t(this),i=e.offset();this!=s.element[0]&&s.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i){for(var s=t(this).data("draggable"),n=s.options,a=n.snapTolerance,r=i.offset.left,o=r+s.helperProportions.width,l=i.offset.top,h=l+s.helperProportions.height,d=s.snapElements.length-1;d>=0;d--){var c=s.snapElements[d].left,u=c+s.snapElements[d].width,p=s.snapElements[d].top,f=p+s.snapElements[d].height;if(c-a<r&&r<u+a&&p-a<l&&l<f+a||c-a<r&&r<u+a&&p-a<h&&h<f+a||c-a<o&&o<u+a&&p-a<l&&l<f+a||c-a<o&&o<u+a&&p-a<h&&h<f+a){if("inner"!=n.snapMode){var g=Math.abs(p-h)<=a,m=Math.abs(f-l)<=a,_=Math.abs(c-o)<=a,v=Math.abs(u-r)<=a;g&&(i.position.top=s._convertPositionTo("relative",{top:p-s.helperProportions.height,left:0}).top-s.margins.top),m&&(i.position.top=s._convertPositionTo("relative",{top:f,left:0}).top-s.margins.top),_&&(i.position.left=s._convertPositionTo("relative",{top:0,left:c-s.helperProportions.width}).left-s.margins.left),v&&(i.position.left=s._convertPositionTo("relative",{top:0,left:u}).left-s.margins.left)}var y=g||m||_||v;if("outer"!=n.snapMode){g=Math.abs(p-l)<=a,m=Math.abs(f-h)<=a,_=Math.abs(c-r)<=a,v=Math.abs(u-o)<=a;g&&(i.position.top=s._convertPositionTo("relative",{top:p,left:0}).top-s.margins.top),m&&(i.position.top=s._convertPositionTo("relative",{top:f-s.helperProportions.height,left:0}).top-s.margins.top),_&&(i.position.left=s._convertPositionTo("relative",{top:0,left:c}).left-s.margins.left),v&&(i.position.left=s._convertPositionTo("relative",{top:0,left:u-s.helperProportions.width}).left-s.margins.left)}!s.snapElements[d].snapping&&(g||m||_||v||y)&&s.options.snap.snap&&s.options.snap.snap.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=g||m||_||v||y}else s.snapElements[d].snapping&&s.options.snap.release&&s.options.snap.release.call(s.element,e,t.extend(s._uiHash(),{snapItem:s.snapElements[d].item})),s.snapElements[d].snapping=!1}}}),t.ui.plugin.add("draggable","stack",{start:function(e,i){var s=t(this).data("draggable").options,n=t.makeArray(t(s.stack.group)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||s.stack.min)-(parseInt(t(i).css("zIndex"),10)||s.stack.min)});t(n).each(function(t){this.style.zIndex=s.stack.min+t}),this[0].style.zIndex=s.stack.min+n.length}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i){var s=t(i.helper),n=t(this).data("draggable").options;s.css("zIndex")&&(n._zIndex=s.css("zIndex")),s.css("zIndex",n.zIndex)},stop:function(e,i){var s=t(this).data("draggable").options;s._zIndex&&t(i.helper).css("zIndex",s._zIndex)}})}(jQuery),jQuery.ui&&jQuery.ui.droppable||function(t){t.widget("ui.droppable",{_init:function(){var e=this.options.accept;this.isover=0,this.isout=1,this.options.accept=this.options.accept&&t.isFunction(this.options.accept)?this.options.accept:function(t){return t.is(e)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},t.ui.ddmanager.droppables[this.options.scope]=t.ui.ddmanager.droppables[this.options.scope]||[],t.ui.ddmanager.droppables[this.options.scope].push(this),this.options.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var e=t.ui.ddmanager.droppables[this.options.scope],i=0;i<e.length;i++)e[i]==this&&e.splice(i,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable")},_setData:function(e,i){"accept"==e?this.options.accept=i&&t.isFunction(i)?i:function(t){return t.is(i)}:t.widget.prototype._setData.apply(this,arguments)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!=this.element[0]&&this.options.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!=this.element[0]&&this.options.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var s=i||t.ui.ddmanager.current;if(!s||(s.currentItem||s.element)[0]==this.element[0])return!1;var n=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"droppable");if(e.options.greedy&&t.ui.intersect(s,t.extend(e,{offset:e.element.offset()}),e.options.tolerance))return n=!0,!1}),!n&&(!!this.options.accept.call(this.element[0],s.currentItem||s.element)&&(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(s)),this.element))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,absolutePosition:t.positionAbs,offset:t.positionAbs}}}),t.extend(t.ui.droppable,{version:"1.7.2",eventPrefix:"drop",defaults:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"}}),t.ui.intersect=function(e,i,s){if(!i.offset)return!1;var n=(e.positionAbs||e.position.absolute).left,a=n+e.helperProportions.width,r=(e.positionAbs||e.position.absolute).top,o=r+e.helperProportions.height,l=i.offset.left,h=l+i.proportions.width,d=i.offset.top,c=d+i.proportions.height;switch(s){case"fit":return l<n&&a<h&&d<r&&o<c;case"intersect":return l<n+e.helperProportions.width/2&&a-e.helperProportions.width/2<h&&d<r+e.helperProportions.height/2&&o-e.helperProportions.height/2<c;case"pointer":var u=(e.positionAbs||e.position.absolute).left+(e.clickOffset||e.offset.click).left,p=(e.positionAbs||e.position.absolute).top+(e.clickOffset||e.offset.click).top;return t.ui.isOver(p,u,d,l,i.proportions.height,i.proportions.width);case"touch":return(r>=d&&r<=c||o>=d&&o<=c||r<d&&o>c)&&(n>=l&&n<=h||a>=l&&a<=h||n<l&&a>h);default:return!1}},t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,i){var s=t.ui.ddmanager.droppables[e.options.scope],n=i?i.type:null,a=(e.currentItem||e.element).find(":data(droppable)").andSelf();t:for(var r=0;r<s.length;r++)if(!(s[r].options.disabled||e&&!s[r].options.accept.call(s[r].element[0],e.currentItem||e.element))){for(var o=0;o<a.length;o++)if(a[o]==s[r].element[0]){s[r].proportions.height=0;continue t}s[r].visible="none"!=s[r].element.css("display"),s[r].visible&&(s[r].offset=s[r].element.offset(),s[r].proportions={width:s[r].element[0].offsetWidth,height:s[r].element[0].offsetHeight},"mousedown"==n&&s[r]._activate.call(s[r],i))}},drop:function(e,i){var s=!1;return t.each(t.ui.ddmanager.droppables[e.options.scope],function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(s=this._drop.call(this,i)),!this.options.disabled&&this.visible&&this.options.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,i)))}),s},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var s=t.ui.intersect(e,this,this.options.tolerance),n=s||1!=this.isover?s&&0==this.isover?"isover":null:"isout";if(n){var a;if(this.options.greedy){var r=this.element.parents(":data(droppable):eq(0)");r.length&&((a=t.data(r[0],"droppable")).greedyChild="isover"==n?1:0)}a&&"isover"==n&&(a.isover=0,a.isout=1,a._out.call(a,i)),this[n]=1,this["isout"==n?"isover":"isout"]=0,this["isover"==n?"_over":"_out"].call(this,i),a&&"isout"==n&&(a.isout=0,a.isover=1,a._over.call(a,i))}}})}}}(jQuery),jQuery.ui&&jQuery.ui.resizable||function(t){t.widget("ui.resizable",t.extend({},t.ui.mouse,{_init:function(){var e=this,i=this.options;if(this.element.addClass("ui-resizable"),t.extend(this,{_aspectRatio:!!i.aspectRatio,aspectRatio:i.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:i.helper||i.ghost||i.animate?i.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(/relative/.test(this.element.css("position"))&&t.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"}),this.element.wrap(t('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=i.handles||(t(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var s=this.handles.split(",");this.handles={};for(var n=0;n<s.length;n++){var a=t.trim(s[n]),r=t('<div class="ui-resizable-handle '+("ui-resizable-"+a)+'"></div>');/sw|se|ne|nw/.test(a)&&r.css({zIndex:++i.zIndex}),"se"==a&&r.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[a]=".ui-resizable-"+a,this.element.append(r)}}this._renderAxis=function(e){for(var i in e=e||this.element,this.handles){if(this.handles[i].constructor==String&&(this.handles[i]=t(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var s,n=t(this.handles[i],this.element);s=/sw|ne|nw|se|n|s/.test(i)?n.outerHeight():n.outerWidth();var a=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");e.css(a,s),this._proportionallyResize()}t(this.handles[i]).length}},this._renderAxis(this.element),this._handles=t(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!e.resizing){if(this.className)var t=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);e.axis=t&&t[1]?t[1]:"se"}}),i.autoHide&&(this._handles.hide(),t(this.element).addClass("ui-resizable-autohide").hover(function(){t(this).removeClass("ui-resizable-autohide"),e._handles.show()},function(){e.resizing||(t(this).addClass("ui-resizable-autohide"),e._handles.hide())})),this._mouseInit()},destroy:function(){this._mouseDestroy();var e=function(e){t(e).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var i=this.element;i.parent().append(this.originalElement.css({position:i.css("position"),width:i.outerWidth(),height:i.outerHeight(),top:i.css("top"),left:i.css("left")})).end().remove()}this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement)},_mouseCapture:function(e){var i=!1;for(var s in this.handles)t(this.handles[s])[0]==e.target&&(i=!0);return this.options.disabled||!!i},_mouseStart:function(i){var s=this.options,n=this.element.position(),a=this.element;this.resizing=!0,this.documentScroll={top:t(document).scrollTop(),left:t(document).scrollLeft()},(a.is(".ui-draggable")||/absolute/.test(a.css("position")))&&a.css({position:"absolute",top:n.top,left:n.left}),t.browser.opera&&/relative/.test(a.css("position"))&&a.css({position:"relative",top:"auto",left:"auto"}),this._renderProxy();var r=e(this.helper.css("left")),o=e(this.helper.css("top"));s.containment&&(r+=t(s.containment).scrollLeft()||0,o+=t(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:r,top:o},this.size=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalSize=this._helper?{width:a.outerWidth(),height:a.outerHeight()}:{width:a.width(),height:a.height()},this.originalPosition={left:r,top:o},this.sizeDiff={width:a.outerWidth()-a.width(),height:a.outerHeight()-a.height()},this.originalMousePosition={left:i.pageX,top:i.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1;var l=t(".ui-resizable-"+this.axis).css("cursor");return t("body").css("cursor","auto"==l?this.axis+"-resize":l),a.addClass("ui-resizable-resizing"),this._propagate("start",i),!0},_mouseDrag:function(e){var i=this.helper,s=(this.options,this.originalMousePosition),n=this.axis,a=e.pageX-s.left||0,r=e.pageY-s.top||0,o=this._change[n];if(!o)return!1;var l=o.apply(this,[e,a,r]);t.browser.msie&&t.browser.version,this.sizeDiff;return(this._aspectRatio||e.shiftKey)&&(l=this._updateRatio(l,e)),l=this._respectSize(l,e),this._propagate("resize",e),i.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(l),this._trigger("resize",e,this.ui()),!1},_mouseStop:function(e){this.resizing=!1;var i=this.options,s=this;if(this._helper){var n=this._proportionallyResizeElements,a=n.length&&/textarea/i.test(n[0].nodeName),r=a&&t.ui.hasScroll(n[0],"left")?0:s.sizeDiff.height,o=a?0:s.sizeDiff.width,l={width:s.size.width-o,height:s.size.height-r},h=parseInt(s.element.css("left"),10)+(s.position.left-s.originalPosition.left)||null,d=parseInt(s.element.css("top"),10)+(s.position.top-s.originalPosition.top)||null;i.animate||this.element.css(t.extend(l,{top:d,left:h})),s.helper.height(s.size.height),s.helper.width(s.size.width),this._helper&&!i.animate&&this._proportionallyResize()}return t("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",e),this._helper&&this.helper.remove(),!1},_updateCache:function(t){this.options;this.offset=this.helper.offset(),i(t.left)&&(this.position.left=t.left),i(t.top)&&(this.position.top=t.top),i(t.height)&&(this.size.height=t.height),i(t.width)&&(this.size.width=t.width)},_updateRatio:function(t,e){this.options;var i=this.position,s=this.size,n=this.axis;return t.height?t.width=s.height*this.aspectRatio:t.width&&(t.height=s.width/this.aspectRatio),"sw"==n&&(t.left=i.left+(s.width-t.width),t.top=null),"nw"==n&&(t.top=i.top+(s.height-t.height),t.left=i.left+(s.width-t.width)),t},_respectSize:function(t,e){this.helper;var s=this.options,n=(this._aspectRatio||e.shiftKey,this.axis),a=i(t.width)&&s.maxWidth&&s.maxWidth<t.width,r=i(t.height)&&s.maxHeight&&s.maxHeight<t.height,o=i(t.width)&&s.minWidth&&s.minWidth>t.width,l=i(t.height)&&s.minHeight&&s.minHeight>t.height;o&&(t.width=s.minWidth),l&&(t.height=s.minHeight),a&&(t.width=s.maxWidth),r&&(t.height=s.maxHeight);var h=this.originalPosition.left+this.originalSize.width,d=this.position.top+this.size.height,c=/sw|nw|w/.test(n),u=/nw|ne|n/.test(n);o&&c&&(t.left=h-s.minWidth),a&&c&&(t.left=h-s.maxWidth),l&&u&&(t.top=d-s.minHeight),r&&u&&(t.top=d-s.maxHeight);var p=!t.width&&!t.height;return p&&!t.left&&t.top?t.top=null:p&&!t.top&&t.left&&(t.left=null),t},_proportionallyResize:function(){this.options;if(this._proportionallyResizeElements.length)for(var e=this.helper||this.element,i=0;i<this._proportionallyResizeElements.length;i++){var s=this._proportionallyResizeElements[i];if(!this.borderDif){var n=[s.css("borderTopWidth"),s.css("borderRightWidth"),s.css("borderBottomWidth"),s.css("borderLeftWidth")],a=[s.css("paddingTop"),s.css("paddingRight"),s.css("paddingBottom"),s.css("paddingLeft")];this.borderDif=t.map(n,function(t,e){return(parseInt(t,10)||0)+(parseInt(a[e],10)||0)})}t.browser.msie&&(t(e).is(":hidden")||t(e).parents(":hidden").length)||s.css({height:e.height()-this.borderDif[0]-this.borderDif[2]||0,width:e.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var e=this.element,i=this.options;if(this.elementOffset=e.offset(),this._helper){this.helper=this.helper||t('<div style="overflow:hidden;"></div>');var s=t.browser.msie&&t.browser.version<7,n=s?1:0,a=s?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+a,height:this.element.outerHeight()+a,position:"absolute",left:this.elementOffset.left-n+"px",top:this.elementOffset.top-n+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(t,e,i){return{width:this.originalSize.width+e}},w:function(t,e,i){this.options;var s=this.originalSize;return{left:this.originalPosition.left+e,width:s.width-e}},n:function(t,e,i){this.options;var s=this.originalSize;return{top:this.originalPosition.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},sw:function(e,i,s){return t.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,i,s]))},ne:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,i,s]))},nw:function(e,i,s){return t.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,i,s]))}},_propagate:function(e,i){t.ui.plugin.call(this,e,[i,this.ui()]),"resize"!=e&&this._trigger(e,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}})),t.extend(t.ui.resizable,{version:"1.7.2",eventPrefix:"resize",defaults:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,cancel:":input,option",containment:!1,delay:0,distance:1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1e3}}),t.ui.plugin.add("resizable","alsoResize",{start:function(e,i){var s=t(this).data("resizable").options;_store=function(e){t(e).each(function(){t(this).data("resizable-alsoresize",{width:parseInt(t(this).width(),10),height:parseInt(t(this).height(),10),left:parseInt(t(this).css("left"),10),top:parseInt(t(this).css("top"),10)})})},"object"!=typeof s.alsoResize||s.alsoResize.parentNode?_store(s.alsoResize):s.alsoResize.length?(s.alsoResize=s.alsoResize[0],_store(s.alsoResize)):t.each(s.alsoResize,function(t,e){_store(t)})},resize:function(e,i){var s=t(this).data("resizable"),n=s.options,a=s.originalSize,r=s.originalPosition,o={height:s.size.height-a.height||0,width:s.size.width-a.width||0,top:s.position.top-r.top||0,left:s.position.left-r.left||0},l=function(e,i){t(e).each(function(){var e=t(this),n=t(this).data("resizable-alsoresize"),a={},r=i&&i.length?i:["width","height","top","left"];t.each(r||["width","height","top","left"],function(t,e){var i=(n[e]||0)+(o[e]||0);i&&i>=0&&(a[e]=i||null)}),/relative/.test(e.css("position"))&&t.browser.opera&&(s._revertToRelativePosition=!0,e.css({position:"absolute",top:"auto",left:"auto"})),e.css(a)})};"object"!=typeof n.alsoResize||n.alsoResize.nodeType?l(n.alsoResize):t.each(n.alsoResize,function(t,e){l(t,e)})},stop:function(e,i){var s=t(this).data("resizable");s._revertToRelativePosition&&t.browser.opera&&(s._revertToRelativePosition=!1,el.css({position:"relative"})),t(this).removeData("resizable-alsoresize-start")}}),t.ui.plugin.add("resizable","animate",{stop:function(e,i){var s=t(this).data("resizable"),n=s.options,a=s._proportionallyResizeElements,r=a.length&&/textarea/i.test(a[0].nodeName),o=r&&t.ui.hasScroll(a[0],"left")?0:s.sizeDiff.height,l=r?0:s.sizeDiff.width,h={width:s.size.width-l,height:s.size.height-o},d=parseInt(s.element.css("left"),10)+(s.position.left-s.originalPosition.left)||null,c=parseInt(s.element.css("top"),10)+(s.position.top-s.originalPosition.top)||null;s.element.animate(t.extend(h,c&&d?{top:c,left:d}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var i={width:parseInt(s.element.css("width"),10),height:parseInt(s.element.css("height"),10),top:parseInt(s.element.css("top"),10),left:parseInt(s.element.css("left"),10)};a&&a.length&&t(a[0]).css({width:i.width,height:i.height}),s._updateCache(i),s._propagate("resize",e)}})}}),t.ui.plugin.add("resizable","containment",{start:function(i,s){var n=t(this).data("resizable"),a=n.options,r=n.element,o=a.containment,l=o instanceof t?o.get(0):/parent/.test(o)?r.parent().get(0):o;if(l)if(n.containerElement=t(l),/document/.test(o)||o==document)n.containerOffset={left:0,top:0},n.containerPosition={left:0,top:0},n.parentData={element:t(document),left:0,top:0,width:t(document).width(),height:t(document).height()||document.body.parentNode.scrollHeight};else{var h=t(l),d=[];t(["Top","Right","Left","Bottom"]).each(function(t,i){d[t]=e(h.css("padding"+i))}),n.containerOffset=h.offset(),n.containerPosition=h.position(),n.containerSize={height:h.innerHeight()-d[3],width:h.innerWidth()-d[1]};var c=n.containerOffset,u=n.containerSize.height,p=n.containerSize.width,f=t.ui.hasScroll(l,"left")?l.scrollWidth:p,g=t.ui.hasScroll(l)?l.scrollHeight:u;n.parentData={element:l,left:c.left,top:c.top,width:f,height:g}}},resize:function(e,i){var s=t(this).data("resizable"),n=s.options,a=(s.containerSize,s.containerOffset),r=(s.size,s.position),o=s._aspectRatio||e.shiftKey,l={top:0,left:0},h=s.containerElement;h[0]!=document&&/static/.test(h.css("position"))&&(l=a),r.left<(s._helper?a.left:0)&&(s.size.width=s.size.width+(s._helper?s.position.left-a.left:s.position.left-l.left),o&&(s.size.height=s.size.width/n.aspectRatio),s.position.left=n.helper?a.left:0),r.top<(s._helper?a.top:0)&&(s.size.height=s.size.height+(s._helper?s.position.top-a.top:s.position.top),o&&(s.size.width=s.size.height*n.aspectRatio),s.position.top=s._helper?a.top:0),s.offset.left=s.parentData.left+s.position.left,s.offset.top=s.parentData.top+s.position.top;var d=Math.abs((s._helper,s.offset.left-l.left+s.sizeDiff.width)),c=Math.abs((s._helper?s.offset.top-l.top:s.offset.top-a.top)+s.sizeDiff.height),u=s.containerElement.get(0)==s.element.parent().get(0),p=/relative|absolute/.test(s.containerElement.css("position"));u&&p&&(d-=s.parentData.left),d+s.size.width>=s.parentData.width&&(s.size.width=s.parentData.width-d,o&&(s.size.height=s.size.width/s.aspectRatio)),c+s.size.height>=s.parentData.height&&(s.size.height=s.parentData.height-c,o&&(s.size.width=s.size.height*s.aspectRatio))},stop:function(e,i){var s=t(this).data("resizable"),n=s.options,a=(s.position,s.containerOffset),r=s.containerPosition,o=s.containerElement,l=t(s.helper),h=l.offset(),d=l.outerWidth()-s.sizeDiff.width,c=l.outerHeight()-s.sizeDiff.height;s._helper&&!n.animate&&/relative/.test(o.css("position"))&&t(this).css({left:h.left-r.left-a.left,width:d,height:c}),s._helper&&!n.animate&&/static/.test(o.css("position"))&&t(this).css({left:h.left-r.left-a.left,width:d,height:c})}}),t.ui.plugin.add("resizable","ghost",{start:function(e,i){var s=t(this).data("resizable"),n=s.options,a=s.size;s.ghost=s.originalElement.clone(),s.ghost.css({opacity:.25,display:"block",position:"relative",height:a.height,width:a.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof n.ghost?n.ghost:""),s.ghost.appendTo(s.helper)},resize:function(e,i){var s=t(this).data("resizable");s.options;s.ghost&&s.ghost.css({position:"relative",height:s.size.height,width:s.size.width})},stop:function(e,i){var s=t(this).data("resizable");s.options;s.ghost&&s.helper&&s.helper.get(0).removeChild(s.ghost.get(0))}}),t.ui.plugin.add("resizable","grid",{resize:function(e,i){var s=t(this).data("resizable"),n=s.options,a=s.size,r=s.originalSize,o=s.originalPosition,l=s.axis;n._aspectRatio||e.shiftKey;n.grid="number"==typeof n.grid?[n.grid,n.grid]:n.grid;var h=Math.round((a.width-r.width)/(n.grid[0]||1))*(n.grid[0]||1),d=Math.round((a.height-r.height)/(n.grid[1]||1))*(n.grid[1]||1);/^(se|s|e)$/.test(l)?(s.size.width=r.width+h,s.size.height=r.height+d):/^(ne)$/.test(l)?(s.size.width=r.width+h,s.size.height=r.height+d,s.position.top=o.top-d):/^(sw)$/.test(l)?(s.size.width=r.width+h,s.size.height=r.height+d,s.position.left=o.left-h):(s.size.width=r.width+h,s.size.height=r.height+d,s.position.top=o.top-d,s.position.left=o.left-h)}});var e=function(t){return parseInt(t,10)||0},i=function(t){return!isNaN(parseInt(t,10))}}(jQuery),function(t,e){function i(){}function s(t){o=[t]}function n(t){k.insertBefore(t,k.firstChild)}function a(t,e,i){return t&&t.apply(e.context||e,i)}function r(t){return/\?/.test(t)?"&":"?"}var o,l="async",h="charset",d="",c="error",u="_jqjsp",p="on",f="onclick",g=p+c,m="onload",_="onreadystatechange",v="removeChild",y="<script/>",b="success",w="timeout",D=t.browser,k=t("head")[0]||document.documentElement,x={},C=0,S={callback:u,url:location.href};function M(p){var M,Q=(p=t.extend({},S,p)).complete,I=p.dataFilter,z=p.callbackParameter,j=p.callback,F=p.cache,E=p.pageCache,P=p.charset,T=p.url,A=p.data,$=p.timeout,N=0,R=i;if(p.abort=function(){!N++&&R()},!1===a(p.beforeSend,p,[p])||N)return p;function H(t){!N++&&e(function(){R(),E&&(x[T]={s:[t]}),I&&(t=I.apply(p,[t])),a(p.success,p,[t,b]),a(Q,p,[p,b])},0)}function J(t){!N++&&e(function(){R(),E&&t!=w&&(x[T]=t),a(p.error,p,[p,t]),a(Q,p,[p,t])},0)}return T=T||d,A=A?"string"==typeof A?A:t.param(A,p.traditional):d,T+=A?r(T)+A:d,z&&(T+=r(T)+encodeURIComponent(z)+"=?"),!F&&!E&&(T+=r(T)+"_"+(new Date).getTime()+"="),T=T.replace(/=\?(&|$)/,"="+j+"$1"),E&&(M=x[T])?M.s?H(M.s[0]):J(M):e(function(a,r,d){if(!N){function p(t){(a[f]||i)(),t=o,o=void 0,t?H(t[0]):J(c)}d=$>0&&e(function(){J(w)},$),R=function(){d&&clearTimeout(d),a[_]=a[f]=a[m]=a[g]=null,k[v](a),r&&k[v](r)},window[j]=s,(a=t(y)[0]).id=u+C++,P&&(a[h]=P),D.msie?(a.event=f,a.htmlFor=a.id,a[_]=function(){/loaded|complete/.test(a.readyState)&&p()}):(a[g]=a[m]=p,D.opera?(r=t(y)[0]).text="jQuery('#"+a.id+"')[0]."+g+"()":a[l]=l),a.src=T,n(a),r&&n(r)}},0),p}M.setup=function(e){t.extend(S,e)},t.jsonp=M}(jQuery,setTimeout),apsinth.msg.main_MessageDialog={close:"Schließen",save:"Speichern",cancel:"Abbrechen",discard:"Verwerfen",abort:"Nein",reset:"Zurücksetzen",ok:"OK"},apsinth.msg.main_Error={requestError:"Es ist ein Problem aufgetreten. Bitte versuchen Sie es später noch einmal."},apsinth.lang="de_DE";var AjaxUtil=Klazz.extend({errorHandler:null,initialize:function(t){this.errorHandler=t},postRequest:function(t,e,i,s){this._executeRequest(!0,t,e,this._handleAjaxSuccess,this._handleAjaxError,i,s)},getRequest:function(t,e,i,s){this._executeRequest(!1,t,e,this._handleAjaxSuccess,this._handleAjaxError,i,s)},rpcRequest:function(t,e,i,s,n,a){var r={jsonrpc:"2.0",method:e,params:i,id:AjaxUtil.requestId++};this._executeRequest(!0,t,r,this._handleAjaxRpcSuccess,this._handleAjaxError,s,n,a)},evalJSON:function(text){try{return eval("("+text+")")}catch(t){throw new Error("Parsing JSON failed - "+t+"\n[[START]]"+text+"[[END]]")}},_escape_unicode:function(t){return t=t.replace(/\u0080/g,"&euro;")},_executeRequest:function(t,e,i,s,n,a,r,o){r&&(a=a.bind(r));var l=apsinth.util.ErrorUtil.wrap(s,this).curry(a),h=apsinth.util.ErrorUtil.wrap(n,this).curry(a),d=null,c=null,u=null;if(t){var p=jQuery.toJSON(i);c="post",d=p=p.replace("#","\\u0023","g"),u="application/json"}else c="get",d=i;jQuery.ajax({url:e,type:c,contentType:u,data:d,beforeSend:function(){},success:l,error:h})},_handleResponse:function(t,e,i){try{e.html&&(e.html=this._escape_unicode(e.html)),t(e,i),i&&!i.handled&&this._handleError(i)}catch(t){this.errorHandler&&this.errorHandler(t)}},_handleError:function(t){this.errorHandler?this.errorHandler(t):console&&console.log(t)},_handleAjaxSuccess:function(t,e){if(t){var i,s=null;try{"OK"!=(i=this.evalJSON(e)).status&&(s={httpCode:e.status,errors:i.errors,exception:i.exception,handled:!1})}catch(t){s={httpCode:e.status,errors:["Parsing JSON response from '"+e.url+"' failed:\n"+e,t],handled:!1}}this._handleResponse(t,i,s)}},_handleAjaxRpcSuccess:function(t,e){if(t){var i,s=null,n=null;try{if(n=(i=this.evalJSON(e)).result,i.error&&"null"!=i.error||i.result instanceof Array&&i.result.status&&"OK"!=i.result.status){var a=i.error.data&&i.error.data.exception?i.error.data.exception:null,r=i.error&&i.error.message?i.error.message:null;n=i,s={httpCode:e.status,errors:[r],exception:a,handled:!1}}}catch(t){s={httpCode:e.status,errors:["Parsing JSON response from '"+e.url+"' failed:\n"+e,t],handled:!1}}this._handleResponse(t,n,s)}},_handleAjaxError:function(t,e){if(t){var i={httpCode:e.status,errors:[e.statusText],handled:!1};this._handleResponse(t,null,i)}}});AjaxUtil.requestId=0,apsinth.util.EventingMixin={mixin:function(t){null==t._lstMap&&(t._lstMap={},t.bind=this._onBind,t.unbind=this._onUnbind,t.trigger=this._onTrigger,t.toHandler=this.toHandler)},toHandler:function(t,e){return null==e&&(e=this),function(i){try{null!=i&&null!=i.target&&null!=i.originalEvent&&null==i.currentTarget&&(i.currentTarget=this),t.apply(e,arguments)}catch(t){apsinth.util.ErrorUtil.onError("Calling handler failed",t)}}},_onBind:function(t,e,i,s){if(null==t)throw new Error("type is null");if(null==e)throw new Error("handler is null");var n=this._lstMap[t];null==n&&(n=this._lstMap[t]=[]),n.push({handler:e,scope:i,data:s})},_onUnbind:function(t,e,i,s){var n=this._lstMap[t],a=!1;if(null!=n)for(var r=0;r<n.length;r++){var o=n[r];if(o.handler==e&&o.scope==i&&o.data==s){n.splice(r,1),a=!0;break}}!a&&window.console&&console.warn("Unbinding handler for "+t+" failed. Handler not found:",e)},_onTrigger:function(t,e){var i=this._lstMap[t];if(null!=i)for(var s=0;s<i.length;s++){var n=i[s];try{n.handler.call(n.scope,e,n.data)}catch(e){apsinth.util.ErrorUtil.onError("Calling "+t+" handler failed",e)}}}},apsinth.util.Blocker=function(t){this._options=jQuery.extend({},this._defaultOptions,t)};var clazz=apsinth.util.Blocker,proto=clazz.prototype;proto._defaultOptions={visible:!1,zIndex:1,onClick:null},proto.show=function(){this.flashContentPrepare();var t,e=this._options;null==this._blockerJQ&&(this._blockerJQ=jQuery(document.createElement("div")),jQuery(document.body).append(this._blockerJQ),this._blockerJQ.addClass("apsinth-blocker").css({zIndex:e.zIndex}),e.onClick&&this._blockerJQ.click(e.onClick)),t=apsinth.util.DomUtil.getViewRect(),apsinth.util.Browser.isIe6&&(this._positionBlockerPane(t),jQuery(window).bind("resize scroll",this._getWindowResizeScrollHandler())),e.visible?this._blockerJQ.fadeTo(0,0).addClass("apsinth-blocker-visible").fadeTo("normal",.2):this._blockerJQ.show(),this._showIe6Iframe(this._blockerJQ,t)},proto.hide=function(){if(this.flashContentUnprepare(),this._blockerJQ){if(this._options.visible){var t=this;this._blockerJQ.fadeOut("normal",function(){t._blockerJQ&&(t._blockerJQ.remove(),t._blockerJQ=null),t._iframeFixJQ&&(t._iframeFixJQ.remove(),t._iframeFixJQ=null)})}else this._blockerJQ.remove(),this._blockerJQ=null,this._iframeFixJQ&&(this._iframeFixJQ.remove(),this._iframeFixJQ=null);apsinth.util.Browser.isIe6&&jQuery(window).unbind("resize scroll",this._getWindowResizeScrollHandler())}},proto._showIe6Iframe=function(t,e){this._iframeFixJQ||(this._iframeFixJQ=jQuery('<iframe src="javascript:\'<html></html>\'" style="filter:alpha(opacity=0.0);">'),this._iframeFixJQ.addClass("apsinth-blocker").hide(),this._iframeFixJQ.css({zIndex:t.css("zIndex")-1}),apsinth.util.Browser.isIe6&&this._iframeFixJQ.css({position:"absolute"})),this._positionIe6Iframe(e),t.before(this._iframeFixJQ),this._iframeFixJQ.show()},proto._positionIe6Iframe=function(t){this._positionElementJQ(this._iframeFixJQ,t)},proto._positionBlockerPane=function(t){this._positionElementJQ(this._blockerJQ,t)},proto._positionElementJQ=function(t,e){t&&(apsinth.util.Browser.isIe6?t.css({width:e.width,height:e.height,top:e.y,left:e.x}):t.css({width:e.width,height:e.height,top:0,left:0}))},proto._getWindowResizeScrollHandler=function(){if(!this._windowResizeScrollHandler){var t=this;this._windowResizeScrollHandler=function(){var e=apsinth.util.DomUtil.getViewRect();t._positionIe6Iframe(e),t._positionBlockerPane(e)}}return this._windowResizeScrollHandler},proto.flashContentPrepare=function(){for(var t,e=document.embeds,i=0;t=e[i];i++){t.setAttribute("wmode","transparent");var s=t.nextSibling,n=t.parentNode;n.removeChild(t),n.insertBefore(t,s)}},proto.flashContentUnprepare=function(){for(var t,e=document.embeds,i=0;t=e[i];i++){var s=t.getAttribute("wmode");t.removeAttribute("wmode");var n=t.nextSibling,a=t.parentNode;a.removeChild(t),s&&t.setAttribute("wmode",s),a.insertBefore(t,n)}},apsinth.util.DomUtil={placeInView:function(t,e,i){null==i&&(i=this.getViewRect());var s=e.x+e.width,n=e.y+e.height;return i.x+i.width<s+t.width&&i.x<=e.x-t.width&&(s=e.x-t.width),i.y+i.height<n+t.height&&i.y<=e.y-t.height&&(n=e.y-t.height),{x:Math.round(s),y:Math.round(n),width:t.width,height:t.height}},getViewRect:function(){var t=jQuery(window),e={x:t.scrollLeft(),y:t.scrollTop()};if(document.documentElement)e.width=document.documentElement.clientWidth,e.height=document.documentElement.clientHeight;else{var i=jQuery(document.body);e.width=i.innerWidth(),e.height=i.innerHeight()}return e}},apsinth.util.ErrorUtil={onError:function(){for(var t="",e="",i=0;i<arguments.length;i++){var s=arguments[i],n=null;s instanceof Error?(e=s.stack,n=s.toString()):"string"==typeof s?n=s.trim():"object"==typeof s?(n="",s.message?n+=s.message:s.errors&&s.errors.length>0&&(n+=s.errors.join("\n")),(s.exception||s.httpCode&&200!=s.httpCode)&&(n+="\n(See console for details)",console&&console.log&&(s.httpCode&&200!=s.httpCode&&console.log("HTTP Code:"+s.httpCode),s.exception&&console.log(s.exception)))):s&&console&&console.log&&console.log(s),t.length>0&&n&&(t+="\n"),n&&(t+=n)}var a=t;0==a.length&&(a="Error during request, see console"),apsinth.debug||(a=apsinth.msg.main_Error.requestError);var r,o=jQuery||!!top.jQuery&&top.jQuery;o&&o(top.window).humanMsg&&(o(top.document).trigger("error.diy-editor",{message:t,stack:e}),o(top.window).humanMsg(a.replace(/\n/gm,"<br/>"))),r=t,console&&console.error&&console.error(r)},wrap:function(t,e){return function(){try{return t.apply(e||this,arguments)}catch(t){apsinth.util.ErrorUtil.onError(t)}}}},apsinth.util.TextUtil={trim:function(t){return t.replace(/^\s+|\s+$/g,"")},escapeHTML:function(t){return t.replace(/<|>|&|"/gi,function(t){switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;"}})},escapeRegexpChars:function(t){return t.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")}},apsinth.util.Layer=function(t,e){if(0!=t){apsinth.util.EventingMixin.mixin(this),e=jQuery.extend({},this._defaultOptions,e),this._usingUiDialog=e.usingUiDialog,null==t&&(t=jQuery(document.createElement("div")),this._autoCreatedMainJQ=!0),this._mainJQ=t;var i=e.zIndex;if(this._usingUiDialog)this._dlgClassName=e.dlgClassName||"diy_dialog",this._dlg=t[this._dlgClassName](jQuery.extend({modal:e.visibleBlocker,autoOpen:!1,resizable:!1},e.dlgOptions));else{null==i&&(i=e.isDialog?apsinth.util.Layer._zIndex.dialog:apsinth.util.Layer._zIndex.control),t.css("z-index",i);var s={zIndex:i-1};e.visibleBlocker?(s.visible=!0,s.onClick=this.toHandler(this.shake)):(s.visible=!1,s.onClick=this.toHandler(this.hide)),this._blocker=new apsinth.util.Blocker(s)}}};var clazz=apsinth.util.Layer,proto=clazz.prototype;clazz._zIndex={dialog:110,control:210},proto._defaultOptions={visibleBlocker:!0,isDialog:!0,usingUiDialog:!1,dlgOptions:null},proto._active=!1,proto.getContent=function(){return this._mainJQ},proto.isActive=function(){return this._active},proto.showBelow=function(t,e,i,s){var n=e?t.outerWidth():null;i&&(n+=i);var a=t.offset();this.show(jQuery.extend({x:a.left,y:a.top+t.outerHeight(),width:n},s))},proto.showAbove=function(t,e,i,s){var n=e?t.innerWidth():null,a=t.offset();this.show(jQuery.extend({x:a.left,y:a.top,width:n+i},s))},proto.showLeftOf=function(t,e,i){var s=t.offset();this.show({x:s.left+e,y:s.top+i,alignRight:!0})},proto.show=function(t){t=jQuery.extend({x:0,y:0,centerX:!1,centerY:!1,alignRight:!1,winWidthMargin:50,winHeightMargin:50,width:null,height:null,addParentWidth:!1,addParentHeight:!1,addWinWidth:!1,addWinHeight:!1,effect:"slide",minWidth:0,reposition:!1,zIndex:null},t),this._usingUiDialog?this._autoCreatedMainJQ||t.reposition||this._mainJQ[this._dlgClassName]("open"):(this._blocker.show(),this._autoCreatedMainJQ?jQuery(document.body).append(this._mainJQ):t.reposition||this._mainJQ.show(),this._mainJQ.addClass("apsinth-dialog"));var e=document.documentElement?document.documentElement.clientWidth:window.innerWidth,i=document.documentElement?document.documentElement.clientHeight:window.innerHeight,s=t.width;t.addParentWidth&&(s+=this._mainJQ.parent().width()),t.addWinWidth&&(s+=e-t.winWidthMargin),null!=s&&(s=Math.max(s,t.minWidth));var n=t.height;t.addParentHeight&&(n+=this._mainJQ.parent().height()),t.addWinHeight&&(n+=i-t.winHeightMargin);var a=this._mainJQ.find("img.origImg").prop("complete");if(this._mainJQ.find("img.origImg").length>0&&!a){this.options=t;var r=this;window.setTimeout(function(){r.show(r.options)},1e3)}else{var o=t.x;t.alignRight?o-=this._mainJQ.width():t.centerX&&(o+=(e-(s||this._mainJQ.width()))/2);var l=t.y;t.centerY&&(l+=this.getScrollTop()+(i-(n||this._mainJQ.height()))/2);var h=[Math.round(o)+"px",Math.round(l)+"px"];this._usingUiDialog?this._mainJQ[this._dlgClassName]("option","position",h):this._mainJQ.css({left:h[0],top:h[1]});var d={};null!=s&&(d.width=Math.round(s)+"px"),null!=n&&(d.height=Math.round(n)+"px"),this._usingUiDialog?this._mainJQ[this._dlgClassName]("option",d):this._mainJQ.css(d),null!==t.zIndex&&(this._usingUiDialog?this._mainJQ[this._dlgClassName]("option","zIndex",t.zIndex):this._mainJQ.css("zIndex",t.zIndex));r=this;var c=function(){r._active=!0};if(jQuery(document.body).hasClass("facebookTab")&&"undefined"!=typeof FB&&void 0!==FB.Canvas&&"function"==typeof FB.Canvas.getPageInfo){r=this;FB.Canvas.getPageInfo(function(e){var i;t.centerY&&(l=t.y+e.scrollTop-e.offsetTop+(e.clientHeight-(n||r._mainJQ.height()))/2,i=Math.round(l)+"px"),r._mainJQ.css("top",i),r.scrollIntoView(),r._usingUiDialog?(r._mainJQ[this._dlgClassName]("open"),c()):"slide"==t.effect?r._mainJQ.slideUp(0).slideDown(void 0,c):"fade"==t.effect?r._mainJQ.fadeOut(0).fadeIn(void 0,c):(r._mainJQ.show(),c()),jQuery(r).trigger("showLayer")})}else this.scrollIntoView(),this._usingUiDialog?(this._mainJQ[this._dlgClassName]("open"),c()):"slide"==t.effect?this._mainJQ.slideUp(0).slideDown(void 0,c):"fade"==t.effect?this._mainJQ.fadeOut(0).fadeIn(void 0,c):(this._mainJQ.show(),c()),jQuery(this).trigger("showLayer")}},proto.scrollIntoView=function(){var t=this._mainJQ.offset().top,e=this._mainJQ.outerHeight(),i=this.getScrollTop(),s=window.document.body.clientHeight||window.innerHeight,n=i;t+e+10>n+s&&(n=t+e+10-s),t-10<n&&(n=t-10),n!=i&&window.scrollTo(0,n)},proto.getScrollTop=function(){return window.pageYOffset||window.document.body.scrollTop||window.document.documentElement.scrollTop},proto.hide=function(){this._active=!1;this._usingUiDialog?this.doHide():(this._blocker.hide(),this._mainJQ.slideUp(void 0,jQuery.proxy(this.doHide,this))),jQuery(this).trigger("hideLayer")},proto.doHide=function(){this._autoCreatedMainJQ?this._mainJQ.remove():this._usingUiDialog?this._mainJQ[this._dlgClassName]("close"):this._mainJQ.hide()},proto.shake=function(){if(!this._usingUiDialog&&!this._shaking){this.scrollIntoView();var t=100,e=this;this._shaking=!0,this._mainJQ.animate({left:"-=20px"},t).animate({left:"+=40px"},t).animate({left:"-=40px"},t).animate({left:"+=20px"},t,void 0,function(){e._shaking=!1})}},proto.destroy=function(){this._usingUiDialog&&this._mainJQ.remove()},apsinth.util.Tabs=function(t,e){e=e||".tabnav",this.tabParentJQ=t;var i=this,s=t.find(e+" li > a"),n=jQuery(s[0]).attr("href");this.selectedTab=n.substr(n.indexOf("#")+1),s.click(function(e){e.preventDefault(),s.each(function(){var e=jQuery(this);apsinth.util.Tabs.setButtonStyle(!1,e,t),i._paneForBtn(e).hide()});var n=jQuery(this);apsinth.util.Tabs.setButtonStyle(!0,n,t);var a=i._paneForBtn(n).show(),r=n.attr("href");if(i.selectedTab=r.substr(r.indexOf("#")+1),i._tabChangedLstArr)for(var o=0;o<i._tabChangedLstArr.length;o++)i._tabChangedLstArr[o].listener.call(i._tabChangedLstArr[o].context,a)}).each(function(e){var s=jQuery(this);0==e?apsinth.util.Tabs.setButtonStyle(!0,s,t):i._paneForBtn(s).hide()})};var clazz=apsinth.util.Tabs,proto=clazz.prototype;clazz.setButtonStyle=function(t,e,i){var s=t?"1px solid "+i.css("backgroundColor"):"";e.css({borderBottom:s})},proto._paneForBtn=function(t){var e=t.attr("href");return this.tabParentJQ.find("."+e.substr(e.indexOf("#")+1))},proto.bindTabChanged=function(t,e){e=e||this,null==this._tabChangedLstArr&&(this._tabChangedLstArr=[]),this._tabChangedLstArr.push({listener:t,context:e})},apsinth.util.Browser={isIe:/MSIE/i.test(navigator.userAgent),isIe6:/MSIE 6/i.test(navigator.userAgent)},apsinth.ApsinthModule=Klazz.extend(Modul,{CONFIG_MIN_WIDTH:550,proxy:null,static_proxy:null,handler_proxy:null,view_proxy:null,configSaveHandler:"config",mainView:"main",data_web:null,data_admin:null,configIsOpen:!1,appendError:!1,errorTarget:"auto",fieldErrorsTarget:"auto",loadMainViewAfterSave:!0,ajaxUtil:null,initialize:function(t,e,i,s){try{apsinth.util.EventingMixin.mixin(this),this.instance_id=e,this.module_name=i,this.mode=s,this.internalContainerId="NGH"+t,this.idPrefix=this.internalContainerId;var n,a=window["__NGHModuleInstanceData"+t];this.moduleServer=a.server,this.data_web=a.data_web,this.data_admin=a.data_admin,n=window.webserverProtocol?"https://"==window.webserverProtocol?sslServerUrl:"":systemurl.slice(0,-1),this.proxy=n+"/proxy",this.static_proxy=this.proxy+"/static",this.handler_proxy=this.proxy+"/handler",this.view_proxy=this.proxy+"/view",this._super(t),this.bind("open-config",this._setMinWidthStyles,this),this.bind("close-config",this._removeMinWidthStyles,this),this.ajaxUtil=new AjaxUtil(this.toHandler(this.onError))}catch(t){apsinth.util.ErrorUtil.onError(t)}},initView_main:function(){apsinth.util.ErrorUtil.wrap(this._initMainView,this)()},initView_config:function(){apsinth.util.ErrorUtil.wrap(this._initConfigView,this)(),this._initDefaultInputValues()},_initMainView:function(){},_initConfigView:function(){},getMainJQ:function(){var t=jQuery("#modul_"+this.moduleId+"_content");return t.length?t:jQuery("#modul_"+this.moduleId)},getConfigJQ:function(){return jQuery("#modul_"+this.moduleId+"_config")},getBasisId:function(){return window.script_basisID},replaceInternalLinks:function(t){var e=new RegExp('href\\s*=\\s*"http://page-(\\d+)/"',"g");return t.replace(e,'href="/app/'+this.getBasisId()+'/$1"')},getFilesUrl:function(t,e){return void 0===e&&(e=this.module_name),this.proxy+"/static/mod/"+e+"/files/"+t},getUploadUrl:function(t){void 0===t&&(t=this.module_name);var e=this.getBasisId(),i=new Array(9-e.length+1).join("0")+e,s=(window.webserverProtocol&&"https://"==window.webserverProtocol?window.sslServerUrl:"")+"/remotemodules/";return"admin"==this.mode&&(s+=i.substr(0,3)+"/"+i.substr(3,3)+"/"+i.substr(6,3)+"/"),s+=t+"/"+this.instance_id},getHandlerUrl:function(t,e){var i=this.handler_proxy+"?mod.module="+this.module_name+"&mod.handler="+t+"&mod.instance_id="+this.instance_id+("admin"==this.mode?"&mod.admin=1":"")+"&mod.locale="+apsinth.lang;return this.buildUrl(i,e)},getViewUrl:function(t,e){var i=this.view_proxy+"?mod.module="+this.module_name+"&mod.view="+t+"&mod.instance_id="+this.instance_id+"&mod.externalModuleId="+this.moduleId+("admin"==this.mode?"&mod.admin=1":"")+"&mod.locale="+apsinth.lang;return this.buildUrl(i,e)},buildUrl:function(t,e){return"object"==typeof e&&jQuery.each(e,function(e,i){t+="&"+encodeURIComponent(e)+"="+encodeURIComponent(i)}),t},getView:function(t,e,i,s){this.ajaxUtil.getRequest(this.getViewUrl(t),e,i,s)},callRpc:function(t,e,i,s){var n=this.module_name+"."+t;e||(e={}),e["mod.instance_id"]=this.instance_id,e["mod.locale"]=apsinth.lang,e["mod.externalModuleId"]=this.moduleId,"admin"==this.mode&&(e["mod.admin"]=1,mm[this.moduleId]instanceof Modul&&(e._diyNewlyAdded=mm[this.moduleId].getIsNew()?1:0)),this.ajaxUtil.rpcRequest(this.proxy+"/rpc/",n,e,i,s)},sendData:function(t,e,i,s){this.ajaxUtil.postRequest(this.getHandlerUrl(t),e,i,s)},onError:function(t,e){apsinth.util.ErrorUtil.onError(t,e)},save:apsinth.util.ErrorUtil.wrap(function(){if(jQuery(".error-msg").hide(),this._removeDefaultInputValues(),this.validateConfig()){var t={data:this.getConfigData(),mod_saveEdit:1};this._initDefaultInputValues();var e="private."+this.configSaveHandler;this.callRpc(e,t,this.toHandler(this.onConfigSaved),this)}else this._initDefaultInputValues()}),onConfigSaved:function(t,e){if(e)this.onConfigSaveFailed(e);else if("FAIL"===t.status&&t.errors)this.onValidationFailed(t);else{if(this.close(!1,!1,void 0,!0),this.loadMainViewAfterSave){this.showLoading();var i=this;this.reloadMainView(null,function(){i.hideLoading()})}jQuery(document).trigger("diy-editor-module-saved",this.moduleId)}},getDiyForm:function(){var t=this.getConfigJQ().find("form");return t.is(":diy-form")||t.diy_form({appendMessage:this.appendError,messageTarget:this.errorTarget}),t},clearErrors:function(){this.getDiyForm().diy_form("clearErrors")},onValidationFailed:function(t){var e=this.getDiyForm(),i=this;e.diy_form("clearErrors"),jQuery.each(t.errors,function(t,s){var n=[];jQuery.each(s,function(t,e){n.push(e)}),n=n.join("<br/>");var a=e.find('input[name="'+t+'"]');a.length>0?("text"!=a.attr("type")||a.is(":diy-formField")||a.diy_textField(),"auto"!=i.fieldErrorsTarget&&"field"!=i.fieldErrorsTarget&&"both"!=i.fieldErrorsTarget||e.diy_form("addError",n,a)):"auto"==i.fieldErrorsTarget&&e.diy_form("addError",n),"general"!=i.fieldErrorsTarget&&"both"!=i.fieldErrorsTarget||e.diy_form("addError",n)})},onConfigSaveFailed:function(t){var e="",i=[],s=[];if(t.errors instanceof Array){for(var n=0,a=t.errors.length;n<a;n++){var r=t.errors[n];r instanceof Object&&r.field?s.push(r):i.push(r)}var o="";if(s&&s instanceof Array&&s.length>0){o="\n<br/> - User-side errors:\n<br/>";for(n=0,a=s.length;n<a;n++)o+=" "+s[n].message+"\n<br/>"}e=" - Server-side error:\n"+i.join("\n")+o}200!=t.httpCode&&(e+="\nHTTP Code: "+t.httpCode),t.exception&&console.log(t.exception),s.length>0&&this.getConfigJQ().find(".x-error-msg").size()>0?this._handleUserErrors(s):apsinth.util.ErrorUtil.onError("Saving config failed"+e),t.handled=!0},_handleUserErrors:function(t){if(t||t instanceof Object){var e=this.getConfigJQ();if(e.find(".x-error-msg").size()>0){for(var i="<ul>",s=0,n=t.length;s<n;s++)i+="<li>"+t[s].message+"</li>";i+="</ul>",e.find(".x-error-msg").html(i).hide(),e.find(".x-error-msg").html(i).fadeIn("100")}}},reloadMainView:function(t,e,i){var s=this,n="public.view"+s.mainView.substring(0,1).toUpperCase()+s.mainView.substr(1);this.callRpc(n,t,function(t,n){n?n.errors&&n.errors instanceof Array&&n.errors.length>0&&s.onError(n.errors.join("\n")):e&&e(t),t.html&&(s.getMainJQ().html(t.html),s.getMainJQ().trigger("contentUpdated"),s.initView_main(),i&&i())})},open:apsinth.util.ErrorUtil.wrap(function(){"function"==typeof Modul.prototype.open&&Modul.prototype.open.apply(this,arguments),!this.configIsOpen&&this.hasConfigView&&(this.trigger("open-config",this),this.configIsOpen=!0)}),close:apsinth.util.ErrorUtil.wrap(function(){"function"==typeof Modul.prototype.close&&Modul.prototype.close.apply(this,arguments),this.clearErrors(),this.trigger("close-config",this),this.configIsOpen=!1}),validateConfig:function(){return!0},getConfigData:function(){return null},_iFrameJQ:null,_iFrame:function(t){var e=null;if(null===this._iFrameJQ){var i=this;e="ewoao"+Math.floor(123456*Math.random());var s=i.getConfigJQ(),n=null;if(jQuery.browser.msie)n=jQuery('<iframe src="about:blank" id="'+e+'" name="'+e+'" style="display: none;" />');else{var a=document.createElement("iframe");a.setAttribute("style","display:none"),a.setAttribute("id",e),a.setAttribute("name",e),n=jQuery(a)}n.load(function(){var e=Array.prototype.slice.call(arguments,0);return e=e.concat([t]),i.loaded.apply(i,e)}),s.append(n),this._iFrameJQ=n}else e=this._iFrameJQ.attr("name");return e},upload:apsinth.util.ErrorUtil.wrap(function(t,e){var i=this,s=(t=jQuery(t)).find("input[type=file]:first"),n=i._iFrame(t);return""!==s.val()&&(t.attr("action",i.getHandlerUrl(e)),t.attr("target",n),"function"!=typeof i.uploadStart||i.uploadStart())}),loaded:function(t,e){var i=t.currentTarget,s=this,n=null;n=i.contentDocument?i.contentDocument:i.contentWindow?i.contentWindow.document:window.frames[id].document,contentJQ=jQuery(n);try{var a=contentJQ.contents().find("body").html();if(""!=a)if(response=jQuery.evalJSON(a),response.status&&"OK"!=response.status){var r={errors:response.errors?response.errors:null};e.trigger("uploadError"),s._uploadError(r)}else"function"==typeof s.uploadComplete&&(e.trigger("uploadSuccess"),s.uploadComplete(response))}catch(t){s._uploadError(t)}},_uploadError:function(t){if("function"==typeof this.uploadError)this.uploadError(t);else{var e=apsinth.msg.conf_Upload.uploadError;t&&t.errors&&t.errors instanceof Array&&t.errors.length>0&&(e+=":\n",e+=t.errors.join("\n")),this.onError(e)}},uploadComplete:function(t){},uploadStart:function(){},_setMinWidthStyles:function(){var t=this.getConfigJQ();t.width()<this.CONFIG_MIN_WIDTH?(this._minWidthSet=!0,t.css({width:this.CONFIG_MIN_WIDTH}),this.trigger("width-adjusted")):t.width()==this.CONFIG_MIN_WIDTH&&t.css("width","auto")},_removeMinWidthStyles:function(){if(this._minWidthSet){if(this._minWidthSet=!1,this.getConfigJQ().css("width","auto"),this._moduleElPosition){var t=jQuery("#modul_"+this.moduleId);t.css("position",this._moduleElPosition),t.css("z-index","")}this.getMainJQ().css("backgroundColor","transparent")}},_initDefaultInputValues:function(t){(t=t||this.getConfigJQ()).find("input[data-default-value]").each(function(t,e){var i=e===document.activeElement&&(e.type||e.href),s=(e=jQuery(e)).val(),n=e.attr("data-default-value");""!=s&&null!=s&&"null"!=s||""==n||(i||(e.addClass("apsinth-default-value"),e.val(n)),e.bind("change.defaultValues",function(t){var e=jQuery(t.currentTarget),i=e.val(),s=e.attr("data-default-value");s&&(""==i?(e.addClass("apsinth-default-value"),e.val(s)):i!=s&&e.removeClass("apsinth-default-value"))}),e.bind("focus.defaultValues",function(t){var e=jQuery(t.currentTarget),i=e.val(),s=e.attr("data-default-value");s&&i==s&&(e.val(""),e.removeClass("apsinth-default-value"))}),e.bind("blur.defaultValues",function(t){var e=jQuery(t.currentTarget),i=e.val(),s=e.attr("data-default-value");s&&""==i&&(e.addClass("apsinth-default-value"),e.val(s))}))})},_removeDefaultInputValues:function(){this.getConfigJQ().find("input[data-default-value]").each(function(t,e){var i=(e=jQuery(e)).val(),s=e.attr("data-default-value");s&&i==s&&e.hasClass("apsinth-default-value")&&(e.removeClass("apsinth-default-value"),e.val(""),e.unbind("change.defaultValues"),e.unbind("focus.defaultValues"),e.unbind("blur.defaultValues"))})}}),function($){$.extend($.ui,{datepicker16:{version:"1.6"}});var PROP_NAME="datepicker16";function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker16-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._promptClass="ui-datepicker-prompt",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this._weekOverClass="ui-datepicker-week-over",this.regional=[],this.regional[""]={clearText:"Clear",clearStatus:"Erase the current date",closeText:"Close",closeStatus:"Close without change",prevText:"&#x3c;Prev",prevStatus:"Show the previous month",prevBigText:"&#x3c;&#x3c;",prevBigStatus:"Show the previous year",nextText:"Next&#x3e;",nextStatus:"Show the next month",nextBigText:"&#x3e;&#x3e;",nextBigStatus:"Show the next year",currentText:"Today",currentStatus:"Show the current month",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthStatus:"Show a different month",yearStatus:"Show a different year",weekHeader:"Wk",weekStatus:"Week of the year",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],dayStatus:"Set DD as first week day",dateStatus:"Select DD, M d",dateFormat:"mm/dd/yy",firstDay:0,initStatus:"Select a date",isRTL:!1},this._defaults={showOn:"focus",showAnim:"show",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,closeAtTop:!0,mandatory:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,showBigPrevNext:!1,gotoCurrent:!1,changeMonth:!0,changeYear:!0,showMonthAfterYear:!1,yearRange:"-10:+10",changeFirstDay:!0,highlightWeek:!1,showOtherMonths:!1,showWeeks:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",showStatus:!1,statusForDate:this.dateStatus,minDate:null,maxDate:null,duration:"normal",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,rangeSelect:!1,rangeSeparator:" - ",altField:"",altFormat:"",constrainInput:!0},$.extend(this._defaults,this.regional[""]),this.dpDiv=$('<div id="'+this._mainDivId+'" style="display: none;"></div>')}function extendRemove(t,e){for(var i in $.extend(t,e),e)null!=e[i]&&null!=e[i]||(t[i]=e[i]);return t}function isArray(t){return t&&($.browser.safari&&"object"==typeof t&&t.length||t.constructor&&t.constructor.toString().match(/\Array\(\)/))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},setDefaults:function(t){return extendRemove(this._defaults,t||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(t){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline="div"==nodeName||"span"==nodeName;target.id||(target.id="dp"+ ++this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),"input"==nodeName?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(t,e){return{id:t[0].id.replace(/([:\[\]\.])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?$('<div class="'+this._inlineClass+'"></div>'):this.dpDiv}},_connectDatepicker:function(t,e){var i=$(t);if(!i.hasClass(this.markerClassName)){var s=this._get(e,"appendText"),n=this._get(e,"isRTL");s&&i[n?"before":"after"]('<span class="'+this._appendClass+'">'+s+"</span>");var a=this._get(e,"showOn");if("focus"!=a&&"both"!=a||i.focus(this._showDatepicker),"button"==a||"both"==a){var r=this._get(e,"buttonText"),o=this._get(e,"buttonImage"),l=$(this._get(e,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:r,title:r}):$('<button type="button"></button>').addClass(this._triggerClass).html(""==o?r:$("<img/>").attr({src:o,alt:r,title:r})));i[n?"before":"after"](l),l.click(function(){return $.datepicker16._datepickerShowing&&$.datepicker16._lastInput==t?$.datepicker16._hideDatepicker():$.datepicker16._showDatepicker(t),!1})}i.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).bind("setData.datepicker16",function(t,i,s){e.settings[i]=s}).bind("getData.datepicker16",function(t,i){return this._get(e,i)}),$.data(t,PROP_NAME,e)}},_inlineDatepicker:function(t,e){var i=$(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv).bind("setData.datepicker16",function(t,i,s){e.settings[i]=s}).bind("getData.datepicker16",function(t,i){return this._get(e,i)}),$.data(t,PROP_NAME,e),this._setDate(e,this._getDefaultDate(e)),this._updateDatepicker(e),this._updateAlternate(e))},_dialogDatepicker:function(t,e,i,s,n){var a=this._dialogInst;if(!a){var r="dp"+ ++this.uuid;this._dialogInput=$('<input type="text" id="'+r+'" size="1" style="position: absolute; top: -100px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),(a=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},$.data(this._dialogInput[0],PROP_NAME,a)}if(extendRemove(a.settings,s||{}),this._dialogInput.val(e),this._pos=n?n.length?n:[n.pageX,n.pageY]:null,!this._pos){var o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,h=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[o/2-100+h,l/2-150+d]}return this._dialogInput.css("left",this._pos[0]+"px").css("top",this._pos[1]+"px"),a.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,a),this},_destroyDatepicker:function(t){var e=$(t);if(e.hasClass(this.markerClassName)){var i=t.nodeName.toLowerCase();$.removeData(t,PROP_NAME),"input"==i?e.siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove().end().removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress):"div"!=i&&"span"!=i||e.removeClass(this.markerClassName).empty()}},_enableDatepicker:function(t){var e=$(t);if(e.hasClass(this.markerClassName)){var i=t.nodeName.toLowerCase();"input"==i?(t.disabled=!1,e.siblings("button."+this._triggerClass).each(function(){this.disabled=!1}).end().siblings("img."+this._triggerClass).css({opacity:"1.0",cursor:""})):"div"!=i&&"span"!=i||e.children("."+this._disableClass).remove(),this._disabledInputs=$.map(this._disabledInputs,function(e){return e==t?null:e})}},_disableDatepicker:function(t){var e=$(t);if(e.hasClass(this.markerClassName)){var i=t.nodeName.toLowerCase();if("input"==i)t.disabled=!0,e.siblings("button."+this._triggerClass).each(function(){this.disabled=!0}).end().siblings("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"});else if("div"==i||"span"==i){var s=e.children("."+this._inlineClass),n=s.offset(),a={left:0,top:0};s.parents().each(function(){if("relative"==$(this).css("position"))return a=$(this).offset(),!1}),e.prepend('<div class="'+this._disableClass+'" style="'+($.browser.msie?"background-color: transparent; ":"")+"width: "+s.width()+"px; height: "+s.height()+"px; left: "+(n.left-a.left)+"px; top: "+(n.top-a.top)+'px;"></div>')}this._disabledInputs=$.map(this._disabledInputs,function(e){return e==t?null:e}),this._disabledInputs[this._disabledInputs.length]=t}},_isDisabledDatepicker:function(t){if(!t)return!1;for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]==t)return!0;return!1},_getInst:function(t){try{return $.data(t,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(t,e,i){var s=e||{};"string"==typeof e&&((s={})[e]=i);var n=this._getInst(t);if(n){this._curInst==n&&this._hideDatepicker(null),extendRemove(n.settings,s);var a=new Date;extendRemove(n,{rangeStart:null,endDay:null,endMonth:null,endYear:null,selectedDay:a.getDate(),selectedMonth:a.getMonth(),selectedYear:a.getFullYear(),currentDay:a.getDate(),currentMonth:a.getMonth(),currentYear:a.getFullYear(),drawMonth:a.getMonth(),drawYear:a.getFullYear()}),this._updateDatepicker(n)}},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){var e=this._getInst(t);e&&this._updateDatepicker(e)},_setDateDatepicker:function(t,e,i){var s=this._getInst(t);s&&(this._setDate(s,e,i),this._updateDatepicker(s),this._updateAlternate(s))},_getDateDatepicker:function(t){var e=this._getInst(t);return e&&!e.inline&&this._setDateFromField(e),e?this._getDate(e):null},_doKeyDown:function(t){var e=$.datepicker16._getInst(t.target),i=!0;if(e._keyEvent=!0,$.datepicker16._datepickerShowing)switch(t.keyCode){case 9:$.datepicker16._hideDatepicker(null,"");break;case 13:var s=$("td."+$.datepicker16._dayOverClass+", td."+$.datepicker16._currentClass,e.dpDiv);return s[0]?$.datepicker16._selectDay(t.target,e.selectedMonth,e.selectedYear,s[0]):$.datepicker16._hideDatepicker(null,$.datepicker16._get(e,"duration")),!1;case 27:$.datepicker16._hideDatepicker(null,$.datepicker16._get(e,"duration"));break;case 33:$.datepicker16._adjustDate(t.target,t.ctrlKey?-$.datepicker16._get(e,"stepBigMonths"):-$.datepicker16._get(e,"stepMonths"),"M");break;case 34:$.datepicker16._adjustDate(t.target,t.ctrlKey?+$.datepicker16._get(e,"stepBigMonths"):+$.datepicker16._get(e,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&$.datepicker16._clearDate(t.target),i=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&$.datepicker16._gotoToday(t.target),i=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&$.datepicker16._adjustDate(t.target,-1,"D"),i=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&$.datepicker16._adjustDate(t.target,t.ctrlKey?-$.datepicker16._get(e,"stepBigMonths"):-$.datepicker16._get(e,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&$.datepicker16._adjustDate(t.target,-7,"D"),i=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&$.datepicker16._adjustDate(t.target,1,"D"),i=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&$.datepicker16._adjustDate(t.target,t.ctrlKey?+$.datepicker16._get(e,"stepBigMonths"):+$.datepicker16._get(e,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&$.datepicker16._adjustDate(t.target,7,"D"),i=t.ctrlKey||t.metaKey;break;default:i=!1}else 36==t.keyCode&&t.ctrlKey?$.datepicker16._showDatepicker(this):i=!1;i&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e=$.datepicker16._getInst(t.target);if($.datepicker16._get(e,"constrainInput")){var i=$.datepicker16._possibleChars($.datepicker16._get(e,"dateFormat")),s=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode);return t.ctrlKey||s<" "||!i||i.indexOf(s)>-1}},_showDatepicker:function(t){if("input"!=(t=t.target||t).nodeName.toLowerCase()&&(t=$("input",t.parentNode)[0]),!$.datepicker16._isDisabledDatepicker(t)&&$.datepicker16._lastInput!=t){var e=$.datepicker16._getInst(t),i=$.datepicker16._get(e,"beforeShow");extendRemove(e.settings,i?i.apply(t,[t,e]):{}),$.datepicker16._hideDatepicker(null,""),$.datepicker16._lastInput=t,$.datepicker16._setDateFromField(e),$.datepicker16._inDialog&&(t.value=""),$.datepicker16._pos||($.datepicker16._pos=$.datepicker16._findPos(t),$.datepicker16._pos[1]+=t.offsetHeight);var s=!1;$(t).parents().each(function(){return!(s|="fixed"==$(this).css("position"))}),s&&$.browser.opera&&($.datepicker16._pos[0]-=document.documentElement.scrollLeft,$.datepicker16._pos[1]-=document.documentElement.scrollTop);var n={left:$.datepicker16._pos[0],top:$.datepicker16._pos[1]};if($.datepicker16._pos=null,e.rangeStart=null,e.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker16._updateDatepicker(e),e.dpDiv.width($.datepicker16._getNumberOfMonths(e)[1]*$(".ui-datepicker",e.dpDiv[0])[0].offsetWidth),n=$.datepicker16._checkOffset(e,n,s),e.dpDiv.css({position:$.datepicker16._inDialog&&$.blockUI?"static":s?"fixed":"absolute",display:"none",left:n.left+"px",top:n.top+"px"}),!e.inline){var a=$.datepicker16._get(e,"showAnim")||"show",r=$.datepicker16._get(e,"duration"),o=function(){$.datepicker16._datepickerShowing=!0,$.browser.msie&&parseInt($.browser.version,10)<7&&$("iframe.ui-datepicker-cover").css({width:e.dpDiv.width()+4,height:e.dpDiv.height()+4})};$.effects&&$.effects[a]?e.dpDiv.show(a,$.datepicker16._get(e,"showOptions"),r,o):e.dpDiv[a](r,o),""==r&&o(),"hidden"!=e.input[0].type&&e.input[0].focus(),$.datepicker16._curInst=e}}},_updateDatepicker:function(t){var e={width:t.dpDiv.width()+4,height:t.dpDiv.height()+4};t.dpDiv.empty().append(this._generateHTML(t)).find("iframe.ui-datepicker-cover").css({width:e.width,height:e.height});var i=this._getNumberOfMonths(t);t.dpDiv[(1!=i[0]||1!=i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t.input&&"hidden"!=t.input[0].type&&t==$.datepicker16._curInst&&$(t.input[0]).focus()},_checkOffset:function(t,e,i){var s=t.input?this._findPos(t.input[0]):null,n=window.innerWidth||(document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),a=window.innerHeight||(document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),r=document.documentElement.scrollLeft||document.body.scrollLeft,o=document.documentElement.scrollTop||document.body.scrollTop;return this._get(t,"isRTL")||e.left+t.dpDiv.width()-r>n?e.left=Math.max(i?0:r,s[0]+(t.input?t.input.width():0)-(i?r:0)-t.dpDiv.width()-(i&&$.browser.opera?document.documentElement.scrollLeft:0)):e.left-=i?r:0,e.top+t.dpDiv.height()-o>a?e.top=Math.max(i?0:o,s[1]-(i?o:0)-(this._inDialog?0:t.dpDiv.height())-(i&&$.browser.opera?document.documentElement.scrollTop:0)):e.top-=i?o:0,e},_findPos:function(t){for(;t&&("hidden"==t.type||1!=t.nodeType);)t=t.nextSibling;var e=$(t).offset();return[e.left,e.top]},_hideDatepicker:function(t,e,i){var s=this._curInst;if(s&&(!t||s==$.data(t,PROP_NAME))){var n=this._get(s,"element"),a=this._get(s,"noEndDate");if(i&&n.val(a),this._get(s,"rangeSelect")&&s.stayOpen&&this._selectDate("#"+s.id,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear)),s.stayOpen=!1,this._datepickerShowing){e=null!=e?e:this._get(s,"duration");var r=this._get(s,"showAnim"),o=function(){$.datepicker16._tidyDialog(s)};""!=e&&$.effects&&$.effects[r]?s.dpDiv.hide(r,$.datepicker16._get(s,"showOptions"),e,o):s.dpDiv[""==e?"hide":"slideDown"==r?"slideUp":"fadeIn"==r?"fadeOut":"hide"](e,o),""==e&&this._tidyDialog(s);var l=this._get(s,"onClose");l&&l.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]),this._datepickerShowing=!1,this._lastInput=null,s.settings.prompt=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}this._curInst=null}},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker"),$("."+this._promptClass,t.dpDiv).remove()},_checkExternalClick:function(t){if($.datepicker16._curInst){var e=$(t.target);0!=e.parents("#"+$.datepicker16._mainDivId).length||e.hasClass($.datepicker16.markerClassName)||e.hasClass($.datepicker16._triggerClass)||!$.datepicker16._datepickerShowing||$.datepicker16._inDialog&&$.blockUI||$.datepicker16._hideDatepicker(null,"")}},_adjustDate:function(t,e,i){var s=$(t),n=this._getInst(s[0]);this._adjustInstDate(n,e,i),this._updateDatepicker(n)},_gotoToday:function(t){var e=$(t),i=this._getInst(e[0]);if(this._get(i,"gotoCurrent")&&i.currentDay)i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear;else{var s=new Date;i.selectedDay=s.getDate(),i.drawMonth=i.selectedMonth=s.getMonth(),i.drawYear=i.selectedYear=s.getFullYear()}this._notifyChange(i),this._adjustDate(e)},_selectMonthYear:function(t,e,i){var s=$(t),n=this._getInst(s[0]);n._selectingMonthYear=!1,n["selected"+("M"==i?"Month":"Year")]=n["draw"+("M"==i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(n),this._adjustDate(s)},_clickMonthYear:function(t){var e=$(t),i=this._getInst(e[0]);i.input&&i._selectingMonthYear&&!$.browser.msie&&i.input[0].focus(),i._selectingMonthYear=!i._selectingMonthYear},_changeFirstDay:function(t,e){var i=$(t),s=this._getInst(i[0]);s.settings.firstDay=e,this._updateDatepicker(s)},_selectDay:function(t,e,i,s){if(!$(s).hasClass(this._unselectableClass)){var n=$(t),a=this._getInst(n[0]),r=this._get(a,"rangeSelect");r&&(a.stayOpen=!a.stayOpen,a.stayOpen&&($(".ui-datepicker td",a.dpDiv).removeClass(this._currentClass),$(s).addClass(this._currentClass))),a.selectedDay=a.currentDay=$("a",s).html(),a.selectedMonth=a.currentMonth=e,a.selectedYear=a.currentYear=i,a.stayOpen?a.endDay=a.endMonth=a.endYear=null:r&&(a.endDay=a.currentDay,a.endMonth=a.currentMonth,a.endYear=a.currentYear),this._selectDate(t,this._formatDate(a,a.currentDay,a.currentMonth,a.currentYear)),a.stayOpen?(a.rangeStart=this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay)),this._updateDatepicker(a)):r&&(a.selectedDay=a.currentDay=a.rangeStart.getDate(),a.selectedMonth=a.currentMonth=a.rangeStart.getMonth(),a.selectedYear=a.currentYear=a.rangeStart.getFullYear(),a.rangeStart=null,a.inline&&this._updateDatepicker(a))}},_clearDate:function(t){var e=$(t),i=this._getInst(e[0]);this._get(i,"mandatory")||(i.stayOpen=!1,i.endDay=i.endMonth=i.endYear=i.rangeStart=null,this._selectDate(e,""))},_selectDate:function(t,e){var i=$(t),s=this._getInst(i[0]);e=null!=e?e:this._formatDate(s),this._get(s,"rangeSelect")&&e&&(e=(s.rangeStart?this._formatDate(s,s.rangeStart):e)+this._get(s,"rangeSeparator")+e),s.input&&s.input.val(e),this._updateAlternate(s);var n=this._get(s,"onSelect");n?n.apply(s.input?s.input[0]:null,[e,s]):s.input&&s.input.trigger("change"),s.inline?this._updateDatepicker(s):s.stayOpen||(this._hideDatepicker(null,this._get(s,"duration")),this._lastInput=s.input[0],"object"!=typeof s.input[0]&&s.input[0].focus(),this._lastInput=null)},_updateAlternate:function(t){var e=this._get(t,"altField");if(e){var i=this._get(t,"altFormat")||this._get(t,"dateFormat"),s=this._getDate(t);dateStr=isArray(s)?s[0]||s[1]?this.formatDate(i,s[0],this._getFormatConfig(t))+this._get(t,"rangeSeparator")+this.formatDate(i,s[1]||s[0],this._getFormatConfig(t)):"":this.formatDate(i,s,this._getFormatConfig(t)),$(e).each(function(){$(this).val(dateStr)})}},noWeekends:function(t){var e=t.getDay();return[e>0&&e<6,""]},iso8601Week:function(t){var e=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=new Date(e.getFullYear(),0,4),s=i.getDay()||7;return i.setDate(i.getDate()+1-s),s<4&&e<i?(e.setDate(e.getDate()-3),$.datepicker16.iso8601Week(e)):e>new Date(e.getFullYear(),11,28)&&(s=new Date(e.getFullYear()+1,0,4).getDay()||7)>4&&(e.getDay()||7)<s-3?1:Math.floor((e-i)/864e5/7)+1},dateStatus:function(t,e){return $.datepicker16.formatDate($.datepicker16._get(e,"dateStatus"),t,$.datepicker16._getFormatConfig(e))},parseDate:function(t,e,i){if(null==t||null==e)throw"Invalid arguments";if(""==(e="object"==typeof e?e.toString():e+""))return null;for(var s=(i?i.shortYearCutoff:null)||this._defaults.shortYearCutoff,n=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,a=(i?i.dayNames:null)||this._defaults.dayNames,r=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,o=(i?i.monthNames:null)||this._defaults.monthNames,l=-1,h=-1,d=-1,c=-1,u=!1,p=function(e){var i=v+1<t.length&&t.charAt(v+1)==e;return i&&v++,i},f=function(t){p(t);for(var i="@"==t?14:"y"==t?4:"o"==t?3:2,s=i,n=0;s>0&&_<e.length&&e.charAt(_)>="0"&&e.charAt(_)<="9";)n=10*n+parseInt(e.charAt(_++),10),s--;if(s==i)throw"Missing number at position "+_;return n},g=function(t,i,s){for(var n=p(t)?s:i,a=0,r=0;r<n.length;r++)a=Math.max(a,n[r].length);for(var o="",l=_;a>0&&_<e.length;){o+=e.charAt(_++);for(var h=0;h<n.length;h++)if(o==n[h])return h+1;a--}throw"Unknown name at position "+l},m=function(){if(e.charAt(_)!=t.charAt(v))throw"Unexpected literal at position "+_;_++},_=0,v=0;v<t.length;v++)if(u)"'"!=t.charAt(v)||p("'")?m():u=!1;else switch(t.charAt(v)){case"d":d=f("d");break;case"D":g("D",n,a);break;case"o":c=f("o");break;case"m":h=f("m");break;case"M":h=g("M",r,o);break;case"y":l=f("y");break;case"@":l=(b=new Date(f("@"))).getFullYear(),h=b.getMonth()+1,d=b.getDate();break;case"'":p("'")?m():u=!0;break;default:m()}if(-1==l?l=(new Date).getFullYear():l<100&&(l+=(new Date).getFullYear()-(new Date).getFullYear()%100+(l<=s?0:-100)),c>-1)for(h=1,d=c;;){var y=this._getDaysInMonth(l,h-1);if(d<=y)break;h++,d-=y}var b;if((b=this._daylightSavingAdjust(new Date(l,h-1,d))).getFullYear()!=l||b.getMonth()+1!=h||b.getDate()!=d)throw"Invalid date";return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TIMESTAMP:"@",W3C:"yy-mm-dd",formatDate:function(t,e,i){if(!e)return"";var s=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,n=(i?i.dayNames:null)||this._defaults.dayNames,a=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,r=(i?i.monthNames:null)||this._defaults.monthNames,o=function(e){var i=u+1<t.length&&t.charAt(u+1)==e;return i&&u++,i},l=function(t,e,i){var s=""+e;if(o(t))for(;s.length<i;)s="0"+s;return s},h=function(t,e,i,s){return o(t)?s[e]:i[e]},d="",c=!1;if(e)for(var u=0;u<t.length;u++)if(c)"'"!=t.charAt(u)||o("'")?d+=t.charAt(u):c=!1;else switch(t.charAt(u)){case"d":d+=l("d",e.getDate(),2);break;case"D":d+=h("D",e.getDay(),s,n);break;case"o":for(var p=e.getDate(),f=e.getMonth()-1;f>=0;f--)p+=this._getDaysInMonth(e.getFullYear(),f);d+=l("o",p,3);break;case"m":d+=l("m",e.getMonth()+1,2);break;case"M":d+=h("M",e.getMonth(),a,r);break;case"y":d+=o("y")?e.getFullYear():(e.getYear()%100<10?"0":"")+e.getYear()%100;break;case"@":d+=e.getTime();break;case"'":o("'")?d+="'":c=!0;break;default:d+=t.charAt(u)}return d},_possibleChars:function(t){for(var e="",i=!1,s=0;s<t.length;s++)if(i)"'"!=t.charAt(s)||lookAhead("'")?e+=t.charAt(s):i=!1;else switch(t.charAt(s)){case"d":case"m":case"y":case"@":e+="0123456789";break;case"D":case"M":return null;case"'":lookAhead("'")?e+="'":i=!0;break;default:e+=t.charAt(s)}return e},_get:function(t,e){return void 0!==t.settings[e]?t.settings[e]:this._defaults[e]},_setDateFromField:function(t){var e=this._get(t,"dateFormat"),i=t.input?t.input.val().split(this._get(t,"rangeSeparator")):null;t.endDay=t.endMonth=t.endYear=null;var s=defaultDate=this._getDefaultDate(t);if(i.length>0){var n=this._getFormatConfig(t);i.length>1&&(s=this.parseDate(e,i[1],n)||defaultDate,t.endDay=s.getDate(),t.endMonth=s.getMonth(),t.endYear=s.getFullYear());try{s=this.parseDate(e,i[0],n)||defaultDate}catch(t){this.log(t),s=defaultDate}}t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),t.currentDay=i[0]?s.getDate():0,t.currentMonth=i[0]?s.getMonth():0,t.currentYear=i[0]?s.getFullYear():0,this._adjustInstDate(t)},_getDefaultDate:function(t){var e=this._determineDate(this._get(t,"defaultDate"),new Date),i=this._getMinMaxDate(t,"min",!0),s=this._getMinMaxDate(t,"max");return e=i&&e<i?i:e,e=s&&e>s?s:e},_determineDate:function(t,e){return(t=(t=null==t?e:"string"==typeof t?function(t,e){for(var i=new Date,s=i.getFullYear(),n=i.getMonth(),a=i.getDate(),r=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,o=r.exec(t);o;){switch(o[2]||"d"){case"d":case"D":a+=parseInt(o[1],10);break;case"w":case"W":a+=7*parseInt(o[1],10);break;case"m":case"M":n+=parseInt(o[1],10),a=Math.min(a,e(s,n));break;case"y":case"Y":s+=parseInt(o[1],10),a=Math.min(a,e(s,n))}o=r.exec(t)}return new Date(s,n,a)}(t,this._getDaysInMonth):"number"==typeof t?isNaN(t)?e:function(t){var e=new Date;return e.setDate(e.getDate()+t),e}(t):t)&&"Invalid Date"==t.toString()?e:t)&&(t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)),this._daylightSavingAdjust(t)},_daylightSavingAdjust:function(t){return t?(t.setHours(t.getHours()>12?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,a=t.selectedYear;e=this._determineDate(e,new Date),t.selectedDay=t.currentDay=e.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=e.getMonth(),t.drawYear=t.selectedYear=t.currentYear=e.getFullYear(),this._get(t,"rangeSelect")&&(i?(i=this._determineDate(i,null),t.endDay=i.getDate(),t.endMonth=i.getMonth(),t.endYear=i.getFullYear()):(t.endDay=t.currentDay,t.endMonth=t.currentMonth,t.endYear=t.currentYear)),n==t.selectedMonth&&a==t.selectedYear||this._notifyChange(t),this._adjustInstDate(t),t.input&&t.input.val(s?"":this._formatDate(t)+(this._get(t,"rangeSelect")?this._get(t,"rangeSeparator")+this._formatDate(t,t.endDay,t.endMonth,t.endYear):""))},_getDate:function(t){var e=!t.currentYear||t.input&&""==t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this._get(t,"rangeSelect")?[t.rangeStart||e,t.endYear?this._daylightSavingAdjust(new Date(t.endYear,t.endMonth,t.endDay)):t.rangeStart||e]:e},_generateHTML:function(t){var e=new Date;e=this._daylightSavingAdjust(new Date(e.getFullYear(),e.getMonth(),e.getDate()));var i=this._get(t,"showStatus"),s=this._get(t,"initStatus")||"&#xa0;",n=this._get(t,"isRTL"),a=this._get(t,"mandatory")?"":'<div class="ui-datepicker-clear"><a onclick="jQuery.datepicker16._clearDate(\'#'+t.id+"');\""+this._addStatus(i,t.id,this._get(t,"clearStatus"),s)+">"+this._get(t,"clearText")+"</a></div>",r='<div class="ui-datepicker-control">'+(n?"":a)+'<div class="ui-datepicker-close"><a onclick="jQuery.datepicker16._hideDatepicker();"'+this._addStatus(i,t.id,this._get(t,"closeStatus"),s)+">"+this._get(t,"closeText")+"</a></div>"+(n?a:"")+"</div>",o=this._get(t,"prompt"),l=this._get(t,"closeAtTop"),h=this._get(t,"hideIfNoPrevNext"),d=this._get(t,"navigationAsDateFormat"),c=this._get(t,"showBigPrevNext"),u=this._getNumberOfMonths(t),p=this._get(t,"showCurrentAtPos"),f=this._get(t,"stepMonths"),g=this._get(t,"stepBigMonths"),m=1!=u[0]||1!=u[1],_=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),v=this._getMinMaxDate(t,"min",!0),y=this._getMinMaxDate(t,"max"),b=t.drawMonth-p,w=t.drawYear;if(b<0&&(b+=12,w--),y){var D=this._daylightSavingAdjust(new Date(y.getFullYear(),y.getMonth()-u[1]+1,y.getDate()));for(D=v&&D<v?v:D;this._daylightSavingAdjust(new Date(w,b,1))>D;)--b<0&&(b=11,w--)}var k=this._get(t,"prevText");k=d?this.formatDate(k,this._daylightSavingAdjust(new Date(w,b-f,1)),this._getFormatConfig(t)):k;var x=c?this._get(t,"prevBigText"):"";x=d?this.formatDate(x,this._daylightSavingAdjust(new Date(w,b-g,1)),this._getFormatConfig(t)):x;var C='<div class="ui-datepicker-prev">'+(this._canAdjustMonth(t,-1,w,b)?(c?"<a onclick=\"jQuery.datepicker16._adjustDate('#"+t.id+"', -"+g+", 'M');\""+this._addStatus(i,t.id,this._get(t,"prevBigStatus"),s)+">"+x+"</a>":"")+"<a onclick=\"jQuery.datepicker16._adjustDate('#"+t.id+"', -"+f+", 'M');\""+this._addStatus(i,t.id,this._get(t,"prevStatus"),s)+">"+k+"</a>":h?"":(c?"<label>"+x+"</label>":"")+"<label>"+k+"</label>")+"</div>",S=this._get(t,"nextText");S=d?this.formatDate(S,this._daylightSavingAdjust(new Date(w,b+f,1)),this._getFormatConfig(t)):S;var M=c?this._get(t,"nextBigText"):"";M=d?this.formatDate(M,this._daylightSavingAdjust(new Date(w,b+g,1)),this._getFormatConfig(t)):M;var Q='<div class="ui-datepicker-next">'+(this._canAdjustMonth(t,1,w,b)?"<a onclick=\"jQuery.datepicker16._adjustDate('#"+t.id+"', +"+f+", 'M');\""+this._addStatus(i,t.id,this._get(t,"nextStatus"),s)+">"+S+"</a>"+(c?"<a onclick=\"jQuery.datepicker16._adjustDate('#"+t.id+"', +"+g+", 'M');\""+this._addStatus(i,t.id,this._get(t,"nextBigStatus"),s)+">"+M+"</a>":""):h?"":"<label>"+S+"</label>"+(c?"<label>"+M+"</label>":""))+"</div>",I=this._get(t,"currentText"),z=this._get(t,"gotoCurrent")&&t.currentDay?_:e;I=d?this.formatDate(I,z,this._getFormatConfig(t)):I;var j=(l&&!t.inline?r:"")+'<div class="ui-datepicker-links">'+(n?Q:C)+(this._isInRange(t,z)?'<div class="ui-datepicker-current"><a onclick="jQuery.datepicker16._gotoToday(\'#'+t.id+"');\""+this._addStatus(i,t.id,this._get(t,"currentStatus"),s)+">"+I+"</a></div>":"")+(n?C:Q)+"</div>"+(o?'<div class="'+this._promptClass+'"><span>'+o+"</span></div>":""),F=parseInt(this._get(t,"firstDay"),10);F=isNaN(F)?0:F;for(var E=this._get(t,"changeFirstDay"),P=this._get(t,"dayNames"),T=this._get(t,"dayNamesShort"),A=this._get(t,"dayNamesMin"),N=this._get(t,"monthNames"),R=this._get(t,"beforeShowDay"),H=this._get(t,"highlightWeek"),J=this._get(t,"showOtherMonths"),O=this._get(t,"showWeeks"),Y=this._get(t,"calculateWeek")||this.iso8601Week,U=this._get(t,"weekStatus"),W=i?this._get(t,"dayStatus")||s:"",B=this._get(t,"statusForDate")||this.dateStatus,L=t.endDay?this._daylightSavingAdjust(new Date(t.endYear,t.endMonth,t.endDay)):_,V=this._getDefaultDate(t),K=0;K<u[0];K++)for(var q=0;q<u[1];q++){var G=this._daylightSavingAdjust(new Date(w,b,t.selectedDay));j+='<div class="ui-datepicker-one-month'+(0==q?" ui-datepicker-new-row":"")+'">'+this._generateMonthYearHeader(t,b,w,v,y,G,K>0||q>0,i,s,N)+'<table class="ui-datepicker" cellpadding="0" cellspacing="0"><thead><tr class="ui-datepicker-title-row">'+(O?"<td"+this._addStatus(i,t.id,U,s)+">"+this._get(t,"weekHeader")+"</td>":"");for(var X=0;X<7;X++){var Z=(X+F)%7,tt=W.indexOf("DD")>-1?W.replace(/DD/,P[Z]):W.replace(/D/,T[Z]);j+="<td"+((X+F+6)%7>=5?' class="ui-datepicker-week-end-cell"':"")+">"+(E?"<a onclick=\"jQuery.datepicker16._changeFirstDay('#"+t.id+"', "+Z+');"':"<span")+this._addStatus(i,t.id,tt,s)+' title="'+P[Z]+'">'+A[Z]+(E?"</a>":"</span>")+"</td>"}j+="</tr></thead><tbody>";var et=this._getDaysInMonth(w,b);w==t.selectedYear&&b==t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,et));for(var it=(this._getFirstDayOfMonth(w,b)-F+7)%7,st=m?6:Math.ceil((it+et)/7),nt=this._daylightSavingAdjust(new Date(w,b,1-it)),at=0;at<st;at++){j+='<tr class="ui-datepicker-days-row">'+(O?'<td class="ui-datepicker-week-col"'+this._addStatus(i,t.id,U,s)+">"+Y(nt)+"</td>":"");for(X=0;X<7;X++){var rt=R?R.apply(t.input?t.input[0]:null,[nt]):[!0,""],ot=nt.getMonth()!=b,lt=ot||!rt[0]||v&&nt<v||y&&nt>y;j+='<td class="ui-datepicker-days-cell'+((X+F+6)%7>=5?" ui-datepicker-week-end-cell":"")+(ot?" ui-datepicker-other-month":"")+(nt.getTime()==G.getTime()&&b==t.selectedMonth&&t._keyEvent||V.getTime()==nt.getTime()&&V.getTime()==G.getTime()?" "+$.datepicker16._dayOverClass:"")+(lt?" "+this._unselectableClass:"")+(ot&&!J?"":" "+rt[1]+(nt.getTime()>=_.getTime()&&nt.getTime()<=L.getTime()?" "+this._currentClass:"")+(nt.getTime()==e.getTime()?" ui-datepicker-today":""))+'"'+(ot&&!J||!rt[2]?"":' title="'+rt[2]+'"')+(lt?H?" onmouseover=\"jQuery(this).parent().addClass('"+this._weekOverClass+"');\" onmouseout=\"jQuery(this).parent().removeClass('"+this._weekOverClass+"');\"":"":" onmouseover=\"jQuery(this).addClass('"+this._dayOverClass+"')"+(H?".parent().addClass('"+this._weekOverClass+"')":"")+";"+(!i||ot&&!J?"":"jQuery('#ui-datepicker-status-"+t.id+"').html('"+(B.apply(t.input?t.input[0]:null,[nt,t])||s)+"');")+'" onmouseout="jQuery(this).removeClass(\''+this._dayOverClass+"')"+(H?".parent().removeClass('"+this._weekOverClass+"')":"")+";"+(!i||ot&&!J?"":"jQuery('#ui-datepicker-status-"+t.id+"').html('"+s+"');")+'" onclick="jQuery.datepicker16._selectDay(\'#'+t.id+"',"+b+","+w+', this);"')+">"+(ot?J?nt.getDate():"&#xa0;":lt?nt.getDate():"<a>"+nt.getDate()+"</a>")+"</td>",nt.setDate(nt.getDate()+1),nt=this._daylightSavingAdjust(nt)}j+="</tr>"}++b>11&&(b=0,w++),j+="</tbody></table></div>"}var ht=jQuery(t.input),dt=this._get(t,"endDateClass"),ct=this._get(t,"repetitionEndDateClass");(ht.hasClass(dt)||ht.hasClass(ct))&&(j+='<div class="cancel-date"><input class="cancel" type="button" value="'+this._get(t,"noEndDateButton")+"\" onclick=\"jQuery.datepicker16._hideDatepicker('','',true);\" /></div>");return j+=(i?'<div style="clear: both;"></div><div id="ui-datepicker-status-'+t.id+'" class="ui-datepicker-status">'+s+"</div>":"")+(l||t.inline?"":r)+'<div style="clear: both;"></div>'+($.browser.msie&&parseInt($.browser.version,10)<7&&!t.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover"></iframe>':""),t._keyEvent=!1,j},_generateMonthYearHeader:function(t,e,i,s,n,a,r,o,l,h){s=t.rangeStart&&s&&a<s?a:s;var d=this._get(t,"changeMonth"),c=this._get(t,"changeYear"),u=this._get(t,"showMonthAfterYear"),p='<div class="ui-datepicker-header">',f="";if(r||!d)f+=h[e];else{var g=s&&s.getFullYear()==i,m=n&&n.getFullYear()==i;f+='<select class="ui-datepicker-new-month" onchange="jQuery.datepicker16._selectMonthYear(\'#'+t.id+"', this, 'M');\" onclick=\"jQuery.datepicker16._clickMonthYear('#"+t.id+"');\""+this._addStatus(o,t.id,this._get(t,"monthStatus"),l)+">";for(var _=0;_<12;_++)(!g||_>=s.getMonth())&&(!m||_<=n.getMonth())&&(f+='<option value="'+_+'"'+(_==e?' selected="selected"':"")+">"+h[_]+"</option>");f+="</select>"}if(u||(p+=f+(r||d||c?"&#xa0;":"")),r||!c)p+=i;else{var v=this._get(t,"yearRange").split(":"),y=0,b=0;for(2!=v.length?(y=i-10,b=i+10):"+"==v[0].charAt(0)||"-"==v[0].charAt(0)?(y=b=(new Date).getFullYear(),y+=parseInt(v[0],10),b+=parseInt(v[1],10)):(y=parseInt(v[0],10),b=parseInt(v[1],10)),y=s?Math.max(y,s.getFullYear()):y,b=n?Math.min(b,n.getFullYear()):b,p+='<select class="ui-datepicker-new-year" onchange="jQuery.datepicker16._selectMonthYear(\'#'+t.id+"', this, 'Y');\" onclick=\"jQuery.datepicker16._clickMonthYear('#"+t.id+"');\""+this._addStatus(o,t.id,this._get(t,"yearStatus"),l)+">";y<=b;y++)p+='<option value="'+y+'"'+(y==i?' selected="selected"':"")+">"+y+"</option>";p+="</select>"}return u&&(p+=(r||d||c?"&#xa0;":"")+f),p+="</div>"},_addStatus:function(t,e,i,s){return t?" onmouseover=\"jQuery('#ui-datepicker-status-"+e+"').html('"+(i||s)+"');\" onmouseout=\"jQuery('#ui-datepicker-status-"+e+"').html('"+s+"');\"":""},_adjustInstDate:function(t,e,i){var s=t.drawYear+("Y"==i?e:0),n=t.drawMonth+("M"==i?e:0),a=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"==i?e:0),r=this._daylightSavingAdjust(new Date(s,n,a)),o=this._getMinMaxDate(t,"min",!0),l=this._getMinMaxDate(t,"max");r=o&&r<o?o:r,r=l&&r>l?l:r,t.selectedDay=r.getDate(),t.drawMonth=t.selectedMonth=r.getMonth(),t.drawYear=t.selectedYear=r.getFullYear(),"M"!=i&&"Y"!=i||this._notifyChange(t)},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){var e=this._get(t,"numberOfMonths");return null==e?[1,1]:"number"==typeof e?[1,e]:e},_getMinMaxDate:function(t,e,i){var s=this._determineDate(this._get(t,e+"Date"),null);return i&&t.rangeStart&&(!s||t.rangeStart>s)?t.rangeStart:s},_getDaysInMonth:function(t,e){return 32-new Date(t,e,32).getDate()},_getFirstDayOfMonth:function(t,e){return new Date(t,e,1).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),a=this._daylightSavingAdjust(new Date(i,s+(e<0?e:n[1]),1));return e<0&&a.setDate(this._getDaysInMonth(a.getFullYear(),a.getMonth())),this._isInRange(t,a)},_isInRange:function(t,e){var i=t.rangeStart?this._daylightSavingAdjust(new Date(t.selectedYear,t.selectedMonth,t.selectedDay)):null,s=(i=i&&t.rangeStart<i?t.rangeStart:i)||this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max");return(!s||e>=s)&&(!n||e<=n)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);var n=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,"dateFormat"),n,this._getFormatConfig(t))}}),$.fn.datepicker16=function(t){$.datepicker16.initialized||($(document.body).append($.datepicker16.dpDiv).mousedown($.datepicker16._checkExternalClick),$.datepicker16.initialized=!0);var e=Array.prototype.slice.call(arguments,1);return"string"!=typeof t||"isDisabled"!=t&&"getDate"!=t?this.each(function(){"string"==typeof t?$.datepicker16["_"+t+"Datepicker"].apply($.datepicker16,[this].concat(e)):$.datepicker16._attachDatepicker(this,t)}):$.datepicker16["_"+t+"Datepicker"].apply($.datepicker16,[this[0]].concat(e))},$.datepicker16=new Datepicker,$.datepicker16.initialized=!1,$.datepicker16.uuid=(new Date).getTime(),$.datepicker16.version="1.6"}(jQuery),window.FormModule={msg:{},fieldConfig:{},Field:function(){},FieldArray:function(){}},FormModule.msg.error={max_email:"Sie können maximal 3 E-Mail-Adressen als Empfänger festlegen.",email_required:"Geben Sie mind. 1 Empfänger-E-Mail-Adresse ein.",empty_enabled_fields:"Alle aktivierten Felder müssen einen Namen haben.",captchafield:"Captcha (Spam-Schutz-Code)",legalcheckbox:"Datenschutzkonformitätserklärung nicht bestätigt"};var Form=apsinth.ApsinthModule.extend({CONFIG_MIN_WIDTH:550,fields:new FormModule.FieldArray,fieldGroups:{},fieldConfig:{},deletableEventsSet:!1,maxEmails:3,maxDeletableFields:5,errorTarget:".form-error",initialize:function(t,e,i,s){this._super(t,e,i,s)},_initMainView:function(){var t=this;this.getMainJQ().find("form[data-form-id="+t.moduleId+"]").submit(function(e){if(t.hideAllErrors(),"admin"===t.mode)return!1;if(!t.validateFields())return!1;var i={fields:t.getFieldsData()};try{i._contactFormPageId=jQuery("body").attr("id").match(/page-([0-9]+)/)[1],i.proxyRequestPath=window.location.pathname,"undefined"!=typeof webServerName&&-1!=document.location.protocol.indexOf("https")&&-1==document.location.hostname.indexOf(webServerName)&&(i.proxyRequestPath=i.proxyRequestPath.replace(webServerName+"/",""))}catch(e){}return t.getMainJQ().find("[name=captcha]").size()>0&&(i.captcha=t.getMainJQ().find("[name=captcha]").val()),t.getMainJQ().find("[name=cap]").size()>0&&(i.cap=t.getMainJQ().find("[name=cap]").val()),t.getMainJQ().find("[name=legal]").size()>0&&(i.legal=t.getMainJQ().find("[name=legal]").is(":checked")),t.callRpc("public.submitForm",i,function(e,i){e.status?(t.getMainJQ().find(".form-headline, form").hide(),t.getMainJQ().find(".form-success").show(),t.getMainJQ().find(".form-success-content").html(e.message)):e.error&&"notvalid"===e.error?(t.showAllErrors(e.ids),t.getMainJQ().find(".refresh").click()):e.error&&"sendfailed"===e.error&&(t.showSendError(),t.getMainJQ().find(".refresh").click())}),!1}),t.getConfigJQ().find(".text-email").keyup(function(){t.validateConfig()})},save:function(){this.showLoading(),this._super(arguments)},validateFields:function(){var t=[],e=!0;if(this.getMainJQ().find("[data-field-id]").removeClass("error").each(function(i){var s=jQuery(this);if(s.is("[data-field-required]")){var n=jQuery.trim(s.val()||"");""===n?(s.addClass("error"),e=!1,t.push(s.attr("data-field-id"))):s.is("[data-field-email]")&&(/^[a-z0-9\0-\uD7FF\uE000-\uFFFF!#$%&'*+\/=?^_`\{|\}~-]+(?:\.[a-z0-9\0-\uD7FF\uE000-\uFFFF!#$%&'*+\/=?^_`\{|\}~-]+)*@(?:[a-z0-9\0-\uD7FF\uE000-\uFFFF](?:[a-z0-9\0-\uD7FF\uE000-\uFFFF-]*[a-z0-9\0-\uD7FF\uE000-\uFFFF])?\.)+[a-z0-9\0-\uD7FF\uE000-\uFFFF](?:[a-z0-9\0-\uD7FF\uE000-\uFFFF-]*[a-z0-9\0-\uD7FF\uE000-\uFFFF])?$/i.test(n)||(e=!1,s.addClass("error"),t.push(s.attr("data-field-id"))))}}),1===this.getMainJQ().find("input[name=captcha]").size()){var i=this.getMainJQ().find("input[name=captcha]").val();""==jQuery.trim(i)&&(e=!1,t.push("captcha"))}return this.showAllErrors(t),e},showAllErrors:function(t){if(0!==t.length){for(var e=this.getMainJQ().find(".form-errors").show().find("ul"),i=[],s=0;s<t.length;s++)if("captcha"!==t[s])if("legal"!==t[s]){var n=jQuery("[data-field-id="+t[s]+"]").is("textarea")?"textarea":"text";i.push(this.getMainJQ().find("label[for=mod-form-"+this.moduleId+"-"+n+"-"+t[s]+"]").find("span").text())}else i.push(FormModule.msg.error.legalcheckbox),this.getMainJQ().find("[name=legal]").addClass("error");else i.push(FormModule.msg.error.captchafield),this.getMainJQ().find("[name=captcha]").addClass("error");e.append("<li>"+i.join("</li><li>")+"</li>")}},showSendError:function(){this.getMainJQ().find(".form-error-send").show()},hideAllErrors:function(){this.getMainJQ().find(".form-errors").hide().find("ul").empty(),this.getMainJQ().find("[name=captcha]").removeClass("error"),this.getMainJQ().find(".form-error-send").hide()},getFieldsData:function(){var t={};return this.getMainJQ().find("[data-field-id]").each(function(e){var i=jQuery(this),s=i.attr("data-field-id");i.is("textarea")||i.is("input[type=text]")?t[s]=i.val():i.is("input[type=checkbox]")&&(t[s]=i.is(":checked"))}),t},_initConfigView:function(){var t=this.getConfigJQ();this.initFields(FormModule.fieldConfig[this.moduleId]),t.find("input[type='text'], textarea").diy_textField(),this.form=t.find("form").diy_form({messageTarget:".form-error"}),this.clearError()},getSettings:function(){var t=this.getConfigJQ(),e={email:t.find("input[name=email]").val(),captcha:t.find("input[name=captcha]").is(":checked"),legal:t.find("input[name=legal]").is(":checked"),legal_required:t.find("input[name=legal_required]").is(":checked"),legal_text:t.find("textarea[name=legal_text]").val(),headline:t.find("textarea[name=headline]").val(),fields:[]};for(var i in this.fields)this.fields[i].getId&&!this.fields[i].deleted&&e.fields.push({id:this.fields[i].getId(),name:this.fields[i].getName(),type_id:this.fields[i].getTypeId(),required:this.fields[i].getRequired(),enabled:this.fields[i].getEnabled(),deletable:this.fields[i].getDeletable()});return e},validateConfig:function(){var t=!0,e=(this.getConfigJQ(),this.getSettings());if(this.clearError(),e.email)if(e.email.split(",").length>this.maxEmails)this.showError(FormModule.msg.error.max_email,'input[name="email"]');else{var i=!1,s=e.email.split(",");for(k in s)i=i||!diy.util.validator.isEmail(s[k]);i&&this.showError(FormModule.msg.error.email_required,'input[name="email"]')}else this.showError(FormModule.msg.error.email_required,'input[name="email"]');var n=0;for(var a in this.fields)if(a==parseInt(a)&&this.fields[a].getId&&!this.fields[a].deleted&&this.fields[a].getEnabled()&&0==this.fields[a].getName().length){var r=this.fields[a].getHtml().find(".name-input");"text"!=r.attr("type")||r.is(":diy-formField")||r.diy_textField(),n++,this.showError(FormModule.msg.error.empty_enabled_fields,this.fields[a].getHtml().find(".name-input"))}return n&&(this.showError(FormModule.msg.error.empty_enabled_fields),t=!1),t},getConfigData:function(){this.getConfigJQ();return this.getSettings()},onConfigSaved:function(t,e){this._super(t,e),t.fields&&this.initFields(t.fields)},clearError:function(){this.form.diy_form("clearErrors")},showError:function(t,e){this.form.diy_form("addError",t,e)},initFields:function(t){this.setFieldData(t),this.renderFields()},setFieldData:function(t){this.fieldConfig=t},renderFields:function(){this.getConfigJQ().find("[name=legal]").diy_checkbox(),this.getConfigJQ().find("[name=legal_required]").diy_checkbox(),this.getConfigJQ().find("[name=captcha]").diy_checkbox(),jQuery("#form-fields-"+this.moduleId).html(" "),this.fields=new FormModule.FieldArray,this.fieldGroups={},jQuery.each(this.fieldConfig,this.toHandler(this.renderFieldGroup)),this.refreshDeletableButtons(),this.setDeletableEvents()},renderFieldGroup:function(t,e){var i,s;switch(parseInt(t)){case FormModule.Field.typeText:i="field-text",s=FormModule.msg.config.fields;break;case FormModule.Field.typeCheckbox:i="field-checkbox",s=FormModule.msg.config.checkboxes;break;case FormModule.Field.typeTextarea:i="field-textarea",s=FormModule.msg.config.textareas}var n=jQuery('<div class="form-field-container form-item"/>'),a=jQuery('<span class="form-label" />');n.addClass(i),n.addClass("field-type-"+t),a.text(s+":"),n.append(a),this.fieldGroups[t]=new FormModule.FieldArray,jQuery("#form-fields-"+this.moduleId).append(n);var r=0;jQuery.each(e,this.toHandler(function(e,i){var s=new FormModule.Field(i),a=s.getHtml();n.append(a),0===r&&t==FormModule.Field.typeText&&a.find(".field-quickhelp").addClass("field-quickhelp-required").quickhelp(FormModule.msg.config.tooltip_required,!0),this.fields.push(s),this.fieldGroups[t].push(s),r++}))},refreshDeletableButtons:function(){var t,e,i;for(var s in this.fieldGroups){for(var n in e=[],t=this.fieldGroups[s])(i=t[n]).deletable&&(i.getHtml().addClass("field-line-with-buttons").find(".field-buttons").attr("data-field-index",n).attr("data-field-type",s),e.push(i.getHtml()));1==e.length?(i=e.pop(),jQuery(i).find(".field-button-add").css("display","block"),jQuery(i).find(".field-button-delete").css("display","none")):e.length>1&&(jQuery.each(e,function(t,e){e.find(".field-button-add").hide(),e.find(".field-button-delete").css("display","block")}),e.length<this.maxDeletableFields&&jQuery(e.pop()).find(".field-button-add").css("display","block"))}this._initDefaultInputValues()},setDeletableEvents:function(){this.deletableEventsSet||(this.deletableEventsSet=!0,jQuery(document).unbind(".formAddRemove"+this.instance_id),this.getConfigJQ().on("click.formAddRemove"+this.instance_id,".field-button-add",this.toHandler(this.addFieldHandler)),this.getConfigJQ().on("click.formAddRemove"+this.instance_id,".field-button-delete",this.toHandler(this.removeFieldHandler)))},addField:function(t){if(this.fieldGroups[t]){var e=this.getConfigJQ().find(".field-type-"+t),i=new FormModule.Field;i.typeId=parseInt(t),i.deletable=!0;var s=i.getHtml();e.append(s),this.fields.push(i),this.fieldGroups[t].push(i),this.refreshDeletableButtons()}},removeField:function(t,e){this.fieldGroups[t][e]&&(this.fieldGroups[t][e].deleted=!0,this.fieldGroups[t][e].getHtml().remove(),this.fieldGroups[t].remove(parseInt(e)),this.refreshDeletableButtons())},addFieldHandler:function(t){var e=jQuery(t.currentTarget).parent().attr("data-field-type");e&&this.addField(e)},removeFieldHandler:function(t){var e=jQuery(t.currentTarget),i=e.parent().attr("data-field-type"),s=e.parent().attr("data-field-index");i&&this.removeField(i,s)}});window.shoppingbasket={msg:{}};var Shoppingbasket=apsinth.ApsinthModule.extend({CONFIG_MIN_WIDTH:500,msg_main:null,tax_activeAdress:"inv",tax_cityCheck:0,tax_stateCheck:0,tax_zipCheck:0,initialize:function(t,e,i,s){this._super(t,e,i,s),this.msg_main=shoppingbasket.msg.main_Shoppingbasket},_initMainView:function(){var t=this,e=this.getMainJQ();t._setTaxHandler("inv"),e.find("#del_addr").parent().parent().nextAll("tr:has(td[id^='del'])").hide(),e.find("#del_addr").click(this.toHandler(function(){e.find("#del_addr").is(":checked")?(e.find("#del_addr").parent().parent().nextAll("tr:has(td[id^='del'])").show(),t._setTaxHandler("del")):(e.find("#del_addr").parent().parent().nextAll("tr:has(td[id^='del'])").hide(),t._setTaxHandler("inv"))})),e.find("input[id^='count_']").keydown(this.toHandler(function(t){revertCount=jQuery(t.target).val()})),e.find("input[id^='count_']").keyup(this.toHandler(function(t){if("0"!==jQuery(t.target).val())this._refreshPrices(t);else if(confirm(this.msg_main.delete_article)){var e=jQuery(t.currentTarget).attr("id").split("_");this._deleteArticle(e[1],jQuery(t.target).parent().parent())}else revertCount&&jQuery(t.target).val(revertCount)})),e.find("input[id^='delete_art_']").click(this.toHandler(function(t){if(confirm(this.msg_main.delete_article)){var e=jQuery(t.currentTarget).attr("id").split("_");this._deleteArticle(e[2],jQuery(t.target).parent().parent())}},this)),e.find("#submit").click(this.toHandler(function(t){this._formSubmit()},this)),e.find("#terms_accept_link").click(this.toHandler(function(e){this.callRpc("public.getTerms",null,function(e,i){!i&&e&&!e.errors&&e.terms_text&&(jQuery(".terms-dialog .dlg-text .terms_text").html(e.terms_text),t._showDialog("terms"))})},this)),e.find("#shoppingBasketDialogs").hide()},_initConfigView:function(){var t=this.getConfigJQ(),e=this;t.find("#payment_pp").click(this.toHandler(function(e){t.find("#payment_pp").is(":checked")?t.find("#fieldset-pp_data").show():t.find("#fieldset-pp_data").hide()})),new apsinth.util.Tabs(t).bindTabChanged(function(t){e._onTabChange(t)})},_onTabChange:function(t){t.hasClass("skins-tab")&&this._skinSelector.updateSkins()},getConfigData:function(){this.getConfigJQ();this.bind("open-config",this._onOpen,this)},_refreshPrices:function(t){var e=this,i=[];jQuery("#shoppingBasketTable tbody tr").each(function(t,e){var s=jQuery(e).find("td input[id^='id']").val(),n=jQuery(e).find("td input[id^='count']").val();i.push([s,n])}),"en_CA"==jQuery("#localeGenuine").val()||"en_US"==jQuery("#localeGenuine").val()?("inv"==Shoppingbasket.tax_activeAdress?(activeCity=jQuery("#inv_city").val(),activeState=jQuery("#inv_state").val(),activeZip=jQuery("#inv_pc").val()):"del"==Shoppingbasket.tax_activeAdress&&(activeCity=jQuery("#del_city").val(),activeState=jQuery("#del_state").val(),activeZip=jQuery("#del_pc").val()),e.callRpc("public.update",{orders:i,city:activeCity,state:activeState,zip:activeZip},function(t,i){!i&&t.status&&"OK"===t.status?e._updateView(t):e._showErrorDlg(e.msg_main.update_errors)},this)):e.callRpc("public.update",{orders:i},function(t,i){!i&&t.status&&"OK"===t.status?e._updateView(t):e._showErrorDlg(e.msg_main.update_errors)},this)},_deleteArticle:function(t,e){var i=[];jQuery("#shoppingBasketTable tbody tr").each(function(e,s){if(!jQuery(s).find("#id_"+t).length){var n=jQuery(s).find("td input[id^='id']").val(),a=jQuery(s).find("td input[id^='count']").val();i.push([n,a])}}),"en_CA"==jQuery("#localeGenuine").val()||"en_US"==jQuery("#localeGenuine").val()?("inv"==Shoppingbasket.tax_activeAdress?(activeCity=jQuery("#inv_city").val(),activeState=jQuery("#inv_state").val(),activeZip=jQuery("#inv_pc").val()):"del"==Shoppingbasket.tax_activeAdress&&(activeCity=jQuery("#del_city").val(),activeState=jQuery("#del_state").val(),activeZip=jQuery("#del_pc").val()),this.callRpc("public.update",{orders:i,city:activeCity,state:activeState,zip:activeZip},function(t,i){!i&&t.status&&"OK"===t.status?(jQuery(e).remove(),this._updateView(t)):this._showErrorDlg(this.msg_main.update_errors)},this)):this.callRpc("public.update",{orders:i},function(t,i){!i&&t.status&&"OK"===t.status?(jQuery(e).remove(),this._updateView(t)):this._showErrorDlg(this.msg_main.update_errors)},this)},_updateView:function(t){var e,i=this.getMainJQ();if(i.find("#nodata").remove(),t.nodata)i.find("#shoppingBasketTable tbody").append('<tr id="nodata"><td colspan="7">'+this.msg_main.no_items+"</td></tr>"),i.find("#price_subtotal").html(""),i.find("#price_shipping").html(""),i.find("#price_total").html(""),i.find("#price_total_vat").html(""),i.find("#amount").html("");else{t.products&&i.find("td[id^='price_total_']").each(function(i,s){var n=s.id.split("_");if(n[2])for(var a in t.products)t.products[a].instance_id==n[2]&&(jQuery(s).html(t.products[a].price_total),e=t.products[a].currency)}),t.price_subtotal&&i.find("#price_subtotal").html(t.price_subtotal),t.price_shipping&&i.find("#price_shipping").html(t.price_shipping);var s=t.price_total.replace(e,"");t.price_total&&(i.find("#price_total").html(t.price_total),i.find("#amount").val(t.price_total_clean),"en_CA"!=i.find("#localeGenuine").val()&&"en_US"!=i.find("#localeGenuine").val()||(i.find("td#taxContainer_totalValue").html(t.price_total),i.find("#externalTax").val(t.externalTax),i.find("#amount").val(s))),t.price_total_vat&&(i.find("#price_total_vat").html(t.price_total_vat),"en_CA"!=i.find("#localeGenuine").val()&&"en_US"!=i.find("#localeGenuine").val()||(i.find("#taxContainer_taxValue").html(t.price_total_vat),i.find("#externalTax").val(t.externalTax),i.find("#amount").val(s)))}},_formSubmit:function(){var t=this,e=this.getMainJQ(),i={},s=!1;jQuery("#shoppingBasketTable tbody tr").each(function(t,e){var n=jQuery(e).find("td input[id^='id']").val(),a=jQuery(e).find("td input[id^='count']").val();n&&a&&(s=!0,i[n]=a)});var n={};if(jQuery("#shoppingBasketForm input").each(function(t,e){var i=jQuery(e).attr("name");"checkbox"==jQuery(e).attr("type")?jQuery(e).is(":checked")?n[i]=1:n[i]=!1:"radio"==jQuery(e).attr("type")?jQuery(e).is(":checked")&&(n[i]=jQuery(e).val()):n[i]=jQuery(e).val()}),jQuery("#shoppingBasketForm select").each(function(t,e){var i=jQuery(e).attr("name");n[i]=jQuery(e).val()}),!s)return alert(t.msg_main.no_items),!1;if(jQuery("#externalTax").length>0)var a=jQuery("#externalTax").val();else a="";return t.callRpc("public.checkOut",{orders:i,form:n,externalTax:a},function(i,s){if(e.find(".error_icon").remove(),!s&&i&&!i.errors){if(e.find(".error-hint").hide(),i.ack_text&&jQuery(".ack-dialog .dlg-text .ack_text").html(i.ack_text),i.paypal){var n="<a href='https://www.paypal.com/us/cgi-bin/webscr?business="+encodeURIComponent(jQuery("#ppForm #business").val())+"&item_name="+encodeURIComponent(jQuery("#ppForm #business").val())+"&currency_code="+escape(jQuery("#ppForm #currency_code").val())+"&amount="+encodeURIComponent(jQuery("#ppForm #amount").val())+"&cmd="+encodeURIComponent(jQuery("#ppForm #cmd").val())+"' target='_blank'>"+t.msg_main.paypal_link+"</a>";jQuery(".ack-dialog .dlg-text").append("<br/>"+t.msg_main.paypal_link_text+"<br /><br />"+n),e.find("#ppForm").submit()}return t._showDialog("ack"),!0}if(i&&i.errors){var a=this.msg_main.form_errors;return jQuery.each(i.errors,function(e,i){jQuery.each(i,function(i,s){"msg"!==e?t._showValidationError(e,s):a+="<br />"+s})}),e.find(".error-hint").html(a).show(),!1}},this),!0},_showErrorDlg:function(t){var e=this.getMainJQ();if(null===this._errorDlg){var i=e.find(".shoppingbasket-error-dialog");e.find(document.body).append(i),this._errorDlg=new apsinth.util.Layer(i)}},_implodeRecursive:function(t){var e="",i=this;return jQuery(t).each(function(t,s){e+="string"==typeof s?s:i._implodeRecursive(s)}),e},_showDialog:function(t){var e=this.getMainJQ().find("#shoppingBasketDialogs");jQuery(document.body).append(e),jQuery("."+t+"-dialog").show(),this.getMainJQ().find("."+t+"-dialog").show(),void 0===this.sbDgl&&(this.sbDgl=new apsinth.util.Layer(e)),e.find(".ccclose, .homepage").click(this.toHandler(function(i){e.find("[class$=dialog]").hide(),this.sbDgl.hide(),"ack"===t&&(window.location.href=nonSslServerUrl)},this)),this.sbDgl.showAbove(this.getMainJQ(),!0,0)},_hideDialog:function(){},_showValidationError:function(t,e){var i=this.getMainJQ();e=e.replace(/\'/g,"");var s=document.createElement("span");jQuery(s).addClass("error_icon"),jQuery(s).html(" ");var n=i.find("#"+t);n.length&&"radio"!==jQuery(i.find("[name='"+t+"']")).attr("type")?jQuery(n).next().length?jQuery(n).next().after(s):jQuery(n).after(s):i.find("#"+t+"-label + td").append(s),jQuery(s).bind("mouseover",this.toHandler(function(t){var i=jQuery('<span class="error_popup"></span>');i.text(e),jQuery(t.target).append(i);var s=jQuery(window).width();jQuery(".error_popup").show();var n=jQuery(".error_popup").offset().left;if(n+jQuery(".error_popup").width()>=s){var a=s-n-20;jQuery(".error_popup").width(a);var r=jQuery(".error_popup").html();/(.*?)\s+(.*)(\s).*/.exec(r);r=r.replace(RegExp.$1,RegExp.$1+"<br/>"),jQuery(".error_popup").html(r),jQuery(".error_popup").css({"word-wrap":"break-word","white-space":"normal"})}},this)),jQuery(s).bind("mouseout",this.toHandler(function(t){jQuery(".error_popup").hide(),jQuery(".error_popup").remove()},this))},_setTaxHandler:function(t){var e=this.getMainJQ(),i=e.find("#localeGenuine").val();if(Shoppingbasket.tax_activeAdress=t,"inv"==t?(currentCity=e.find("#inv_city"),currentState=e.find("#inv_state"),currentZip=e.find("#inv_pc")):(currentCity=e.find("#del_city"),currentState=e.find("#del_state"),currentZip=e.find("#del_pc")),"en_CA"==i||"en_US"==i){this._resetTaxHandler(t);var s=this;e.find("div.taxContainer").css("display","block"),e.find("td#taxContainer_taxValue").html("$ 0.00"),e.find("td#taxContainer_totalValue").html(e.find("td#price_total").html()),currentCity.focusout(function(){s._revalidateTaxField(t,"City",currentCity,i)}),currentState.change(function(){s._revalidateTaxField(t,"State",currentState,i)}),currentZip.focusout(function(){s._revalidateTaxField(t,"Zip",currentZip,i)}),0==Shoppingbasket.tax_cityCheck&&0==Shoppingbasket.tax_stateCheck&&0==Shoppingbasket.tax_zipCheck||(s._revalidateTaxField(t,"City",currentCity,i),s._revalidateTaxField(t,"State",currentState,i),s._revalidateTaxField(t,"Zip",currentZip,i))}},_revalidateTaxField:function(t,e,i,s){var n=this.getMainJQ();switch(e){case"City":i.val().length>0?(n.find("img#city_good").css("display","inline"),Shoppingbasket.tax_cityCheck=1):(n.find("img#city_good").css("display","none"),Shoppingbasket.tax_cityCheck=0);break;case"State":"default"!=i.val()?(n.find("img#state_good").css("display","inline"),Shoppingbasket.tax_stateCheck=1):(n.find("img#state_good").css("display","none"),Shoppingbasket.tax_stateCheck=0);break;case"Zip":"en_CA"==s?regex=/^[0-9A-Z]{3}[ ]*[0-9A-Z]{3}$/i:"en_US"==s&&(regex=/^([0-9]{5}|[0-9]{5}[-]?[0-9]{4})$/),result=regex.exec(i.val()),result?(n.find("img#zip_good").css("display","inline"),Shoppingbasket.tax_zipCheck=1):(n.find("img#zip_good").css("display","none"),Shoppingbasket.tax_zipCheck=0)}1==Shoppingbasket.tax_cityCheck&&1==Shoppingbasket.tax_stateCheck&&1==Shoppingbasket.tax_zipCheck?this._refreshPrices():(n.find("#taxContainer_taxValue").html("$ 0.00"),n.find("#taxContainer_totalValue").html(n.find("td#price_total").html()))},_resetTaxHandler:function(t){var e=this.getMainJQ();"inv"==t?(e.find("#del_city").focusout(function(){}),e.find("#del_state").focusout(function(){}),e.find("#del_pc").focusout(function(){}),e.find("div.taxContainer").css("top","-260px")):(e.find("#inv_city").focusout(function(){}),e.find("#inv_state").focusout(function(){}),e.find("#inv_pc").focusout(function(){}),e.find("div.taxContainer").css("top","-177px")),e.find("img#zip_good").css("display","none"),e.find("img#state_good").css("display","none"),e.find("img#city_good").css("display","none"),Shoppingbasket.tax_cityCheck=0,Shoppingbasket.tax_stateCheck=0,Shoppingbasket.tax_zipCheck=0}});shoppingbasket.msg.main_Shoppingbasket={delete_article:"Produkt löschen?",form_errors:"Es sind leider Fehler aufgetreten.",no_items:"Der Warenkorb ist leer.",paypal_link:"zur Bezahlung per PayPal",paypal_link_text:"Falls in Ihrem Browser nicht automatisch ein neues Fenster für die Bezahlung per PayPal geöffnet wird, klicken Sie bitte auf diesen Link:"};